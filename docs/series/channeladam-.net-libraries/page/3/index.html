<!DOCTYPE html>
<html lang="en-au">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">

    <link rel="preconnect dns-prefetch" href="https://fonts.gstatic.com/" crossorigin>

    <link rel="preload" as="script" href="https://cdn.ampproject.org/v0.js"><script async src="https://cdn.ampproject.org/v0.js"></script><script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>





    <link href="https://fonts.googleapis.com/css?family=Roboto|Libre+Franklin" rel="stylesheet">
    <style amp-custom>/*
 * Bootstrap Reboot v4.5.3 (https://getbootstrap.com/)
 * Copyright 2011-2020 The Bootstrap Authors
 * Copyright 2011-2020 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
 * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md)
 */
*,*::before,*::after{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:rgba(0,0,0,0)}article,aside,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0 !important}hr{box-sizing:content-box;height:0;overflow:visible}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem}p{margin-top:0;margin-bottom:1rem}abbr[title],abbr[data-original-title]{text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;border-bottom:0;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul,dl{margin-top:0;margin-bottom:1rem}ol ol,ul ul,ol ul,ul ol{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:80%}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#007bff;text-decoration:none;background-color:transparent}a:hover{color:#0056b3;text-decoration:underline}a:not([href]):not([class]){color:inherit;text-decoration:none}a:not([href]):not([class]):hover{color:inherit;text-decoration:none}pre,code,kbd,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto;-ms-overflow-style:scrollbar}figure{margin:0 0 1rem}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}table{border-collapse:collapse}caption{padding-top:.75rem;padding-bottom:.75rem;color:#6c757d;text-align:left;caption-side:bottom}th{text-align:inherit;text-align:-webkit-match-parent}label{display:inline-block;margin-bottom:.5rem}button{border-radius:0}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}input,button,select,optgroup,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,input{overflow:visible}button,select{text-transform:none}[role="button"]{cursor:pointer}select{word-wrap:normal}button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}button:not(:disabled),[type="button"]:not(:disabled),[type="reset"]:not(:disabled),[type="submit"]:not(:disabled){cursor:pointer}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{padding:0;border-style:none}input[type="radio"],input[type="checkbox"]{box-sizing:border-box;padding:0}textarea{overflow:auto;resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{display:block;width:100%;max-width:100%;padding:0;margin-bottom:.5rem;font-size:1.5rem;line-height:inherit;color:inherit;white-space:normal}progress{vertical-align:baseline}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto}[type="search"]{outline-offset:-2px;-webkit-appearance:none}[type="search"]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}summary{display:list-item;cursor:pointer}template{display:none}[hidden]{display:none !important}.max-width-half{max-width:50%}.m0{margin:0}.mt0{margin-top:0}.mr0{margin-right:0}.mb0{margin-bottom:0}.ml0{margin-left:0}.mx0{margin-left:0;margin-right:0}.my0{margin-top:0;margin-bottom:0}.m1{margin:.5rem}.mt1{margin-top:.5rem}.mr1{margin-right:.5rem}.mb1{margin-bottom:.5rem}.ml1{margin-left:.5rem}.mx1{margin-left:.5rem;margin-right:.5rem}.my1{margin-top:.5rem;margin-bottom:.5rem}.m2{margin:1rem}.mt2{margin-top:1rem}.mr2{margin-right:1rem}.mb2{margin-bottom:1rem}.ml2{margin-left:1rem}.mx2{margin-left:1rem;margin-right:1rem}.my2{margin-top:1rem;margin-bottom:1rem}.m3{margin:2rem}.mt3,h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6{margin-top:2rem}.mr3{margin-right:2rem}.mb3{margin-bottom:2rem}.ml3{margin-left:2rem}.mx3{margin-left:2rem;margin-right:2rem}.my3{margin-top:2rem;margin-bottom:2rem}.m4{margin:4rem}.mt4,#comments{margin-top:4rem}.mr4{margin-right:4rem}.mb4{margin-bottom:4rem}.ml4{margin-left:4rem}.mx4{margin-left:4rem;margin-right:4rem}.my4{margin-top:4rem;margin-bottom:4rem}.mxn1{margin-left:calc(0.5rem * -1);margin-right:calc(0.5rem * -1)}.mxn2{margin-left:calc(1rem * -1);margin-right:calc(1rem * -1)}.mxn3{margin-left:calc(2rem * -1);margin-right:calc(2rem * -1)}.mxn4{margin-left:calc(4rem * -1);margin-right:calc(4rem * -1)}.m-auto{margin:auto}.mt-auto{margin-top:auto}.mr-auto{margin-right:auto}.mb-auto{margin-bottom:auto}.ml-auto{margin-left:auto}.mx-auto,img.center,.page-image-toc-container > div img{margin-left:auto;margin-right:auto}.my-auto{margin-top:auto;margin-bottom:auto}.p0{padding:0}.pt0{padding-top:0}.pr0{padding-right:0}.pb0{padding-bottom:0}.pl0{padding-left:0}.px0{padding-left:0;padding-right:0}.py0{padding-top:0;padding-bottom:0}.p1{padding:.5rem}.pt1{padding-top:.5rem}.pr1{padding-right:.5rem}.pb1{padding-bottom:.5rem}.pl1{padding-left:.5rem}.py1{padding-top:.5rem;padding-bottom:.5rem}.px1{padding-left:.5rem;padding-right:.5rem}.p2{padding:1rem}.pt2{padding-top:1rem}.pr2{padding-right:1rem}.pb2{padding-bottom:1rem}.pl2{padding-left:1rem}.py2{padding-top:1rem;padding-bottom:1rem}.px2{padding-left:1rem;padding-right:1rem}.p3{padding:2rem}.pt3{padding-top:2rem}.pr3{padding-right:2rem}.pb3{padding-bottom:2rem}.pl3{padding-left:2rem}.py3{padding-top:2rem;padding-bottom:2rem}.px3{padding-left:2rem;padding-right:2rem}.p4{padding:4rem}.pt4{padding-top:4rem}.pr4{padding-right:4rem}.pb4{padding-bottom:4rem}.pl4{padding-left:4rem}.py4{padding-top:4rem;padding-bottom:4rem}.px4{padding-left:4rem;padding-right:4rem}.relative{position:relative}.absolute{position:absolute}.fixed{position:fixed}.top-0{top:0}.right-0{right:0}.bottom-0{bottom:0}.left-0{left:0}.inline{display:inline}.block{display:block}.inline-block{display:inline-block}.table{display:table}.table-cell{display:table-cell}.overflow-hidden{overflow:hidden}.overflow-scroll{overflow:scroll}.overflow-auto{overflow:auto}.clearfix:before,.clearfix:after{content:" ";display:table}.clearfix:after{clear:both}.left{float:left}.right{float:right}.fit{max-width:100%}.max-width-1{max-width:24rem}.max-width-2{max-width:32rem}.max-width-3{max-width:48rem}.max-width-4{max-width:64rem}.border-box{box-sizing:border-box}.align-baseline{vertical-align:baseline}.align-top{vertical-align:top}.align-middle{vertical-align:middle}.align-bottom{vertical-align:bottom}.border-none{border:0}.rounded{border-radius:3px}.circle{border-radius:50%}.not-rounded{border-radius:0}.flex,.header-banner > div,.page-image-toc-container,.table-contents-container{display:-ms-flexbox;display:flex}@media (min-width:40em){.sm-flex{display:-ms-flexbox;display:flex}}@media (min-width:52em){.md-flex{display:-ms-flexbox;display:flex}}@media (min-width:64em){.lg-flex{display:-ms-flexbox;display:flex}}.flex-column{-ms-flex-direction:column;flex-direction:column}.flex-wrap,.page-image-toc-container{-ms-flex-wrap:wrap;flex-wrap:wrap}.items-start{-ms-flex-align:start;align-items:flex-start}.items-end{-ms-flex-align:end;align-items:flex-end}.items-center,.header-banner > div,.page-image-toc-container{-ms-flex-align:center;align-items:center}.items-baseline{-ms-flex-align:baseline;align-items:baseline}.items-stretch{-ms-flex-align:stretch;align-items:stretch}.self-start{-ms-flex-item-align:start;align-self:flex-start}.self-end{-ms-flex-item-align:end;align-self:flex-end}.self-center{-ms-flex-item-align:center;-ms-grid-row-align:center;align-self:center}.self-baseline{-ms-flex-item-align:baseline;align-self:baseline}.self-stretch{-ms-flex-item-align:stretch;-ms-grid-row-align:stretch;align-self:stretch}.justify-start{-ms-flex-pack:start;justify-content:flex-start}.justify-end{-ms-flex-pack:end;justify-content:flex-end}.justify-center,.page-image-toc-container,.table-contents-container{-ms-flex-pack:center;justify-content:center}.justify-between{-ms-flex-pack:justify;justify-content:space-between}.justify-around,.header-banner > div{-ms-flex-pack:distribute;justify-content:space-around}.justify-evenly{-ms-flex-pack:space-evenly;justify-content:space-evenly}.content-start{-ms-flex-line-pack:start;align-content:flex-start}.content-end{-ms-flex-line-pack:end;align-content:flex-end}.content-center{-ms-flex-line-pack:center;align-content:center}.content-between{-ms-flex-line-pack:justify;align-content:space-between}.content-around{-ms-flex-line-pack:distribute;align-content:space-around}.content-stretch{-ms-flex-line-pack:stretch;align-content:stretch}.flex-auto{-ms-flex:1 1 auto;flex:1 1 auto;min-width:0;min-height:0}.flex-none{-ms-flex:none;flex:none}.order-0{-ms-flex-order:0;order:0}.order-1{-ms-flex-order:1;order:1}.order-2{-ms-flex-order:2;order:2}.order-3{-ms-flex-order:3;order:3}.order-last{-ms-flex-order:99999;order:99999}.font-family-inherit{font-family:inherit}.font-size-inherit{font-size:inherit}.text-decoration-none{text-decoration:none}.bold{font-weight:bold;font-weight:bold}.regular{font-weight:normal}.italic{font-style:italic}.caps{text-transform:uppercase;letter-spacing:.2em}.left-align{text-align:left}.center{text-align:center}.right-align{text-align:right}.justify{text-align:justify}.nowrap{white-space:nowrap}.break-word{word-wrap:break-word}.line-height-1{line-height:1}.line-height-2{line-height:1.125}.line-height-3{line-height:1.25}.line-height-4{line-height:1.5}.list-style-none{list-style:none}.underline{text-decoration:underline}.truncate{max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.list-reset{list-style:none;padding-left:0}.hide{position:absolute !important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px)}@media (max-width:40em){.xs-hide{display:none !important}}@media (min-width:40em) and (max-width:52em){.sm-hide{display:none !important}}@media (min-width:52em) and (max-width:64em){.md-hide{display:none !important}}@media (min-width:64em){.lg-hide{display:none !important}}.display-none{display:none !important}.h00{font-size:4rem}.h0{font-size:3rem}.h1{font-size:2rem}.h2{font-size:1.5rem}.h3{font-size:1.25rem}.h4{font-size:1rem}.h5{font-size:.875rem}.h6{font-size:.75rem}.page-width,.paper-inner{max-width:1800px}.font-for-content,body{font-family:'Roboto',sans-serif}.font-for-heading,h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6,.header-title,.widget div.h1,.widget div.h2,.navbar nav,.nav-header,.nav-sub-header{font-family:'Libre Franklin',sans-serif;font-weight:bold}body{background-color:#f8f8f8;min-width:400px}ol,ul,dl{padding-left:2rem;padding-right:1rem;margin:0 0 1rem 0}p + ul,p + ol,p + dl{margin-top:-.8rem}p > code,li > code{word-break:break-word}p + div.highlight > pre{margin-top:-.8rem}pre{margin:0 0 2rem 0;padding:1rem .2rem}table{margin-bottom:1rem;display:block;max-width:min-content;overflow-x:auto}table th,table td{padding:0 .5rem}table th{text-align:left;background-color:#f2f2f2}table tr:nth-child(even){background-color:#f2f2f2}table,th,td{border:1px dotted #000}blockquote{margin:1rem 0 1rem 2rem;white-space:normal;overflow-x:auto;font-style:italic}ul li > a:link,ul li > a:visited{background-color:inherit}ul li > a:hover,ul li > a:focus{color:#c03;background-color:inherit;text-decoration:underline}ul li.active{background-color:inherit}ul li.active > a:link,ul li.active > a:visited,ul li.active > a:focus,ul li.active > a:hover{color:#c03;background-color:inherit}ul li.active > a:focus,ul li.active > a:hover{text-decoration:none}a{color:#2476cc}a.active:link,a.active:visited,a.active:focus,a.active:hover{color:#c03}a.active:focus,a.active:hover{text-decoration:none}section{margin-bottom:20px}.content h1,.content .h1{font-size:2.5em}.content h2,.content .h2{font-size:2.1em}.content h3,.content .h3{font-size:1.7em}.content h4,.content .h4{font-size:1.3em}.content h5,.content .h5{font-size:.9em}.content h6,.content .h6{font-size:.6em}.post-content h1,.post-content .h1{font-size:2.1em}.post-content h2,.post-content .h2{font-size:1.7em}.post-content h3,.post-content .h3{font-size:1.3em}.post-content h4,.post-content .h4{font-size:.9em}.post-content h5,.post-content .h5{font-size:.67em}.post-content h6,.post-content .h6{font-size:.5em}.header-banner{height:auto;background-color:#000}.header-banner > div{margin:0 0}.logo-wrapper{float:none;text-align:center}.logo-wrapper a{display:block;line-height:0}.logo-wrapper amp-img{min-width:143px;max-width:143px;min-height:100px}.header-title{font-size:2em;text-align:center;color:#c03;padding:0 25px 0 25px;text-transform:uppercase}.header-title-outer{background-image:url("/img/site/devzone-logo.jpg");background-repeat:no-repeat;background-position:left 0 top 30%;background-size:cover}.header-title{max-height:100px}.header-title span{background-color:#000;padding:0 4px}@media (min-width:930px){.logo-wrapper{float:left;padding-left:10px;padding-right:10px}.logo-wrapper amp-img{max-height:100px}.header-title-outer{margin-left:238px}.header-title-inner{display:table;width:100%;height:100px}.header-title{display:inline-block;display:table-cell;font-size:2.5em;vertical-align:middle;word-spacing:1rem}}.content{margin:0;padding:0;min-width:360px;min-height:800px}.paper-outer{-moz-box-shadow:0 0 40px rgba(0,0,0,0.15);-webkit-box-shadow:0 0 5px rgba(0,0,0,0.15);-goog-ms-box-shadow:0 0 10px #333;box-shadow:0 0 40px rgba(0,0,0,0.15);margin-bottom:1px}.paper-inner{padding:0 .2rem}@media (min-width:930px){.paper-inner{padding:0 2rem}}.page-layout{margin:0 auto 2rem auto;display:grid;grid-row-gap:0;grid-template-areas:"main" "rightpanel"}.page-layout-right-panel{grid-area:rightpanel;min-height:800px;margin-top:2rem;max-width:400px}.page-layout-main{grid-area:main;min-width:400px}.page-layout-main .card-container{height:100%}.page-layout-main .card-container .card{height:100%;min-height:200px}@media (min-width:930px){.page-layout{grid-column-gap:2rem;grid-row-gap:0;grid-auto-rows:1fr;grid-template-columns:6fr 2fr;grid-template-areas:"main rightpanel"}.page-layout-right-panel{margin-top:0}}.page-layout-right-panel .widget .twitter-feed{position:relative;overflow-y:scroll;height:800px;min-height:800px;margin:0 auto;width:350px;height:80vh}.card-container{margin-left:-.5rem;margin-right:-.5rem}.card-container:not(:first-of-type){margin-top:2rem}.card{padding:1rem;background-color:#fff;box-shadow:0 30px 4rem 0 rgba(1,1,1,0.15)}.widget.card{padding:1.5rem}.widget ul{margin:0;padding:.5rem;text-align:left;background-color:#000}.widget ul li{list-style-type:none}.widget ul li > a:link,.widget ul li > a:visited{color:#81beff}.widget ul li > a:hover,.widget ul li > a:focus{color:#c03}.widget ul li.active > a:link,.widget ul li.active > a:visited,.widget ul li.active > a:focus,.widget ul li.active > a:hover{color:#c03}.widget ul li:nth-child(n){margin-bottom:1rem}.widget ul li:last-child,.widget ul li:only-child{margin-bottom:0}.widget div.h1{margin:0;text-align:center;color:#000;font-size:1.8rem}.widget div.h2{text-align:left;color:#000;font-size:1.5rem;font-weight:bold}.navbar{margin-top:1px;border-left:none;border-right:none;border-bottom:none}.navbar nav{font-weight:400;background-color:#000;margin:0 0 0 0;text-align:center}.navbar nav ul{margin:0;padding:0}.navbar nav li{display:inline;list-style-type:none;padding-right:20px}.navbar nav .btn-link{color:#fff}.navbar nav .btn-link.active{color:#c03}.navbar nav .btn-link:hover,.navbar nav .btn-link:focus{color:#c03}.navbar nav .btn-lg{font-size:1.5em}.nav-header{text-align:left;color:#000;font-size:2em}.nav-sub-header{text-align:left;color:#000;font-size:1.5em;padding:20px 0 0 0}ul.nav-stacked{background-color:#000}@media (min-width:930px){navbar nav .btn-lg{font-size:2em}}.post-content img,.library-page-content img,.notebook-page-content img{display:block;max-width:100%;height:auto}.social-share-buttons ul{padding:0}.social-share-buttons ul li{display:inline;list-style-type:none;margin-right:.5rem;vertical-align:bottom}.twitter-share-button-container{vertical-align:bottom;line-height:0}.tag-cloud a{margin-right:.8rem}ul.pager{padding:0;margin:0 0 4rem 0}ul.pager > li{display:inline;list-style-type:none;margin-right:1rem}ul.pager > li > a,ul.pager > li > span{background-color:#000;border-color:#000;color:#fff;padding:.4rem 1rem}ul.pager > li > a:focus,ul.pager > li > a:hover,ul.pager > li > span:focus,ul.pager > li > span:hover{background-color:#000;border-color:#000;color:#c03;text-decoration:underline}ul.pager > .active > a,ul.pager > .active > a:focus,ul.pager > .active > a:hover,ul.pager > .active > span,ul.pager > .active > span:focus,ul.pager > .active > span:hover{background-color:#000;border-color:#000;color:#c03;text-decoration:none}ul.pager > .disabled > a,ul.pager > .disabled > a:focus,ul.pager > .disabled > a:hover,ul.pager > .disabled > span,ul.pager > .disabled > span:focus,ul.pager > .disabled > span:hover{background-color:#000;border-color:#000;color:#808080}.page-image-toc-container > div{width:100%}.page-image-toc-container > div img{max-width:100%;max-height:100% !important}@media (min-width:1300px){.page-image-toc-container > div{display:inline-block;max-width:50%}}.table-contents-container .table-contents{padding:1em}.table-contents-container .table-contents h2,.table-contents-container .table-contents .h2{margin:0 0 1rem 0}.table-contents-container .table-contents ul{list-style:square inside;padding:0}.table-contents-container .table-contents li ul{list-style:circle inside;margin-left:1em}.post-date{font-weight:bold;font-size:smaller;margin-bottom:1em}.post-comment-count{margin-top:10px}code{color:inherit;background-color:inherit;padding:0 0}article{margin-bottom:60px}.graph-container{height:92vh}footer{background-color:#000;padding:2em 0 2em 0;color:#c03}</style>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>

    <link rel="canonical" href="https://devzone.channeladam.com/series/channeladam-.net-libraries/">
    
<title>ChannelAdam .NET Libraries</title>    





<meta itemprop="name" content="ChannelAdam .NET Libraries">
<meta itemprop="description" content="The ChannelAdam Software Development Zone">
<meta property="og:title" content="ChannelAdam .NET Libraries" />
<meta property="og:description" content="The ChannelAdam Software Development Zone" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://devzone.channeladam.com/series/channeladam-.net-libraries/" />
<meta property="og:image" content="https://devzone.channeladam.com/img/channeladam/channeladam-default-share-1.png"/>
<meta property="og:updated_time" content="2021-01-03T00:00:00+00:00" /><meta property="og:site_name" content="ChannelAdam Software Development Zone" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://devzone.channeladam.com/img/channeladam/channeladam-default-share-1.png"/>

<meta name="twitter:title" content="ChannelAdam .NET Libraries"/>
<meta name="twitter:description" content="The ChannelAdam Software Development Zone"/>
<meta name="twitter:site" content="@ChannelAdam"/>

<meta property="article:author" content="https://www.linkedin.com/in/adamcraven" />
<meta property="article:author" content="https://github.com/ChannelAdam" />
<meta property="article:author" content="https://twitter.com/ChannelAdam" />
<meta name="twitter:creator" content="@ChannelAdam"/>
<meta property="article:author" content="https://www.facebook.com/ChannelAdam" />
<meta property="fb:app_id" content="129037487241515" />

    <link rel="icon" href="/img/channeladam/favicon.ico" type="image/ico">

    
    <link href="/series/channeladam-.net-libraries/index.xml" rel="alternate" type="application/rss+xml" title="DevZone.ChannelAdam.com" />
    <link href="/series/channeladam-.net-libraries/index.xml" rel="feed" type="application/rss+xml" title="DevZone.ChannelAdam.com" />
    

    
  </head>
  <body>
    <amp-analytics type="gtag" data-credentials="include">
 <script type="application/json">
 {
  "vars" : {
   "gtag_id": "UA-51874696-2",
   "config" : {
    "UA-51874696-2": { 
     "groups": "default"
    }
   }
  }
 }
 </script>
</amp-analytics>

    <div class="content">
    <div class="paper-outer">
    <header class="header-banner" role="banner">

    <div class="logo-wrapper">
        <a href="https://channeladam.com">
            <amp-img src="/img/channeladam/channeladam-logo.png" alt="ChannelAdam Logo"
            width="285" height="200" layout="intrinsic"></amp-img>
        </a>
    </div>

    <div class="header-title-outer">
        <div class="header-title-inner">
            <div class="header-title">
                <span>Software Development Zone</span>
            </div>
        </div>
    </div>
        
</header>

    <section class="navbar">
    <nav role="navigation">
        <ul>
            <li><a class="btn btn-link btn-lg" href="/">News</a></li>
            <li><a class="btn btn-link btn-lg" href="/library">Library</a></li>
            <li><a class="btn btn-link btn-lg" href="/notebooks">Notebooks</a></li>
        </ul>
    </nav>
</section>

<section class="mx-auto" style="max-width:728px">
    <br/>
    <div data-type="ad" data-publisher="devzone.channeladam.com" data-zone="ron" data-format="728x90"></div>
    <br/>
</section>

<div class="paper-inner mx-auto page-layout">
    <main aria-role="main" class="page-layout-main">
        <div class="card-container">
            <div class="card">

    
    

    
    <article class="content-page-preview">
        <a href="https://devzone.channeladam.com/library/channeladam-soap/">
            <h2 class="post-title">The ChannelAdam SOAP Library</h2>
        </a>

        <div class="content-page-entry">
        
            <h1 id="overview">Overview</h1>
<p>This is an <a href="https://github.com/channeladam/ChannelAdam.Soap" target="_blank">open source</a> (Apache License 2.0) .NET Standard 2.0 code library that provides a fluent API to make it as easy as possible to create a SOAP 1.1 or SOAP 1.2 message.</p>
<p>Among other things, it is perfect for building SOAP envelopes to use in lightweight web frameworks such as <a href="http://nancyfx.org/" target="_blank">Nancy</a>.</p>
<h1 id="getting-started">Getting Started</h1>
<h2 id="nuget-package-installation">NuGet Package Installation</h2>
<p>To install the <a href="https://www.nuget.org/packages/ChannelAdam.Soap" target="_blank">ChannelAdam.Soap NuGet package</a>
run the following command in the Package Manager Console:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>PM&gt; Install-Package ChannelAdam.Soap
</code></pre></div><h2 id="usage">Usage</h2>
<p>There are plenty of overloads and other methods for more advanced usage - see the reference in the next section.</p>
<h3 id="soap-envelope-with-a-header-action-and-body">SOAP Envelope with a Header Action and Body</h3>
<p>Here is a simple example of creating a SOAP 1.1 envelope with a header action and body payload.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#66d9ef">string</span> envelopeXml = SoapBuilder.CreateSoap11Envelope()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    .WithHeader.AddAction(<span style="color:#e6db74">&#34;http://my.action/here&#34;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>    .WithBody.AddEntry(<span style="color:#e6db74">&#34;&lt;myXml&gt;hello from the body&lt;/myXml&gt;&#34;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>    .Build()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>    .ToString();
</code></pre></div><p>And for SOAP 1.2:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#66d9ef">string</span> envelopeXml = SoapBuilder.CreateSoap12Envelope()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    .WithHeader.AddAction(<span style="color:#e6db74">&#34;http://my.action/here&#34;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>    .WithBody.AddEntry(<span style="color:#e6db74">&#34;&lt;myXml&gt;hello from the body&lt;/myXml&gt;&#34;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>    .Build()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>    .ToString();
</code></pre></div><p>There is even an overload to create the body entry from .NET objects.
For instance:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyModel</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> Value { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; } 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>...
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span style="color:#66d9ef">var</span> model = <span style="color:#66d9ef">new</span> MyModel { Value = <span style="color:#e6db74">&#34;hello!&#34;</span> };
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span style="color:#66d9ef">string</span> envelopeXml = SoapBuilder.CreateSoap12Envelope()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    .WithHeader.AddAction(<span style="color:#e6db74">&#34;http://my.action/here&#34;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    .WithBody.AddEntry(model)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>    .Build()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>    .ToString();
</code></pre></div><p>Easy!</p>
<h3 id="soap-faults">SOAP Faults</h3>
<p>To create a SOAP 1.1 fault:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#66d9ef">string</span> envelopeXml = SoapBuilder.CreateSoap11Envelope()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    .WithBody.SetFault(Soap11FaultCode.Client, <span style="color:#e6db74">&#34;SOAP 1.1 fault string here&#34;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>    .Build()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>    .ToString();
</code></pre></div><p>And for a SOAP 1.2 fault:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#66d9ef">string</span> envelopeXml = SoapBuilder.CreateSoap11Envelope()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    .WithBody.SetFault(Soap12FaultCode.Sender, <span style="color:#e6db74">&#34;SOAP 1.2 fault reason here&#34;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>    .Build()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>    .ToString();
</code></pre></div><p>There are overloads to set other SOAP fault value properties as well.</p>
<h1 id="reference">Reference</h1>
<p>This reference assumes that the reader is familiar with SOAP terminology.
For more information see the following SOAP specifications:</p>
<ul>
<li><a href="https://www.w3.org/TR/soap/" target="_blank">SOAP 1.1 Specification</a></li>
<li><a href="https://www.w3.org/TR/soap12-part1/" target="_blank">SOAP 1.2 Specification</a></li>
</ul>
<h2 id="soapbuilder">SoapBuilder</h2>
<p>The <a href="https://github.com/channeladam/ChannelAdam.Soap/blob/master/src/ChannelAdam.Soap/SoapBuilder.cs" target="_blank">SoapBuilder static class</a> is the fluent starting point for building a SOAP 1.1 or SOAP 1.2 envelope.</p>
<p>The <code>SoapBuilder</code> static class has two methods:</p>
<ul>
<li>
<p><code>ISoap11EnvelopeBuilder CreateSoap11Envelope()</code> - to start the process of creating a SOAP 1.1 envelope</p>
</li>
<li>
<p><code>ISoap12EnvelopeBuilder CreateSoap12Envelope()</code> - to start the process of creating a SOAP 1.2 envelope</p>
</li>
</ul>
<p>The <code>ISoap11EnvelopeBuilder</code> interface has two properties and one method:</p>
<ul>
<li>
<p><code>ISoap11BodyBuilder WithBody { get; }</code> - to specify the SOAP body or a fault</p>
</li>
<li>
<p><code>ISoap11HeaderBuilder WithHeader { get; }</code> - to specify the SOAP header</p>
</li>
<li>
<p><code>XContainer Build()</code> - to finally build the SOAP envelope as specified</p>
</li>
</ul>
<p>The <code>ISoap12EnvelopeBuilder</code> interface is similar:</p>
<ul>
<li>
<p><code>ISoap12BodyBuilder WithBody { get; }</code></p>
</li>
<li>
<p><code>ISoap12HeaderBuilder WithHeader { get; }</code></p>
</li>
<li>
<p><code>XContainer Build()</code></p>
</li>
</ul>
<h3 id="usage-of-soapbuilder">Usage of SoapBuilder</h3>
<p>The general procedure for usage is:</p>
<ol>
<li>
<p>Call one of the <code>SoapBuilder.CreateSoap??Envelope()</code> methods.</p>
</li>
<li>
<p>If necessary, add a header via the <code>WithHeader</code> property.</p>
</li>
<li>
<p>Add a body or fault message via the <code>WithBody</code> property.</p>
</li>
<li>
<p>Once all the details have been specified, simply call the <code>Build()</code> method which will return an <code>XContainer</code>.</p>
</li>
<li>
<p>If there is something that you need to do to the contents of the SOAP envelope that is not currently allowed by the API,
then you can always directly modify the elements in the <code>XContainer</code> and do magical things with LINQ.</p>
</li>
<li>
<p>A simple <code>.ToString()</code> on the <code>XContainer</code> returned from <code>Build()</code> will then give you the XML string of the SOAP envelope/payload - by default formatted with indentation. There is also the overload <code>.ToString(System.Xml.Linq.SaveOptions options)</code> that allows you to change the formatting of whitespace and indentation.</p>
</li>
</ol>
<h2 id="specify-the-soap-header">Specify the SOAP Header</h2>
<p>The SOAP header can be specified via the <code>WithHeader</code> property.</p>
<p>For SOAP 1.1, <code>WithHeader</code> chains the following methods:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>ISoap11EnvelopeBuilder AddAction(<span style="color:#66d9ef">string</span> action);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>ISoap11EnvelopeBuilder AddBlock(<span style="color:#66d9ef">string</span> headerXml);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>ISoap11EnvelopeBuilder AddBlock(XContainer headerBlock);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>ISoap11EnvelopeBuilder AddBlock(<span style="color:#66d9ef">object</span> toSerialise);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>ISoap11EnvelopeBuilder AddBlock(<span style="color:#66d9ef">object</span> toSerialise, <span style="color:#66d9ef">string</span> toElementName, <span style="color:#66d9ef">string</span> toElementNamespace);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span>ISoap11EnvelopeBuilder SetStandardSoapEncoding();
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9</span>ISoap11EnvelopeBuilder SetCustomSoapEncoding(<span style="color:#66d9ef">string</span> soapEncodingNamespace);
</code></pre></div><p>Notes:</p>
<ul>
<li><code>AddAction(string action)</code> adds an action header block with the specified action.</li>
<li><code>AddBlock(XContainer headerBlock)</code> adds any arbitrary header block - e.g. from a <code>System.Xml.Linq.XElement</code>.</li>
<li><code>AddBlock(object toSerialise, string toElementName, string toElementNamespace)</code> serialises the given object and during serialisation overrides the XML element name and namespace with those specified.</li>
<li><code>ISoap11EnvelopeBuilder SetStandardSoapEncoding()</code> sets the SoapEncoding attribute to the standard encoding namespace</li>
<li><code>ISoap11EnvelopeBuilder SetCustomSoapEncoding(string soapEncodingNamespace)</code> sets the SoapEncoding attribute to your custom namespace</li>
</ul>
<p>For SOAP 1.2, <code>WithHeader</code> is nearly identical to SOAP 1.1, except an <code>ISoap12EnvelopeBuilder</code> is returned instead of a <code>ISoap11EnvelopeBuilder</code>.</p>
<h2 id="specify-the-soap-body-payload-or-fault">Specify the SOAP Body Payload or Fault</h2>
<p>The SOAP body payload or fault can be specified via the <code>WithBody</code> property which provides the following methods.</p>
<h3 id="for-soap-11">For SOAP 1.1</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>ISoap11EnvelopeBuilder AddEntry(<span style="color:#66d9ef">string</span> bodyXml);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>ISoap11EnvelopeBuilder AddEntry(XContainer fromNode);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>ISoap11EnvelopeBuilder AddEntry(<span style="color:#66d9ef">object</span> toSerialise);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>ISoap11EnvelopeBuilder AddEntry(<span style="color:#66d9ef">object</span> toSerialise, <span style="color:#66d9ef">string</span> toElementName, <span style="color:#66d9ef">string</span> toElementNamespace);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>ISoap11EnvelopeBuilder SetFault(Soap11FaultCode code, <span style="color:#66d9ef">string</span> faultString);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>ISoap11EnvelopeBuilder SetFault(Soap11FaultCode code, <span style="color:#66d9ef">string</span> faultString, <span style="color:#66d9ef">string</span> faultActor);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>ISoap11EnvelopeBuilder SetFault(Soap11FaultCode code, <span style="color:#66d9ef">string</span> faultString, <span style="color:#66d9ef">string</span> faultActor, IEnumerable&lt;XContainer&gt; detailEntries);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>ISoap11EnvelopeBuilder SetStandardSoapEncoding();
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>ISoap11EnvelopeBuilder SetCustomSoapEncoding(<span style="color:#66d9ef">string</span> soapEncodingNamespace);
</code></pre></div><p>Notes:</p>
<ul>
<li><code>AddEntry(object toSerialise, string toElementName, string toElementNamespace)</code> serialises the given object and during serialisation overrides the XML element name and namespace with those specified.</li>
</ul>
<p>SOAP 1.2 Faults are more descriptive than SOAP 1.1, hence the overloads of <code>SetFault</code> with more parameters.</p>
<h3 id="for-soap-12">For SOAP 1.2</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>ISoap12EnvelopeBuilder AddEntry(<span style="color:#66d9ef">string</span> bodyXml);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>ISoap12EnvelopeBuilder AddEntry(XContainer fromNode);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>ISoap12EnvelopeBuilder AddEntry(<span style="color:#66d9ef">object</span> toSerialise);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>ISoap12EnvelopeBuilder AddEntry(<span style="color:#66d9ef">object</span> toSerialise, <span style="color:#66d9ef">string</span> toElementName, <span style="color:#66d9ef">string</span> toElementNamespace);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>ISoap12EnvelopeBuilder SetFault(Soap12FaultCode code, <span style="color:#66d9ef">string</span> reason);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>ISoap12EnvelopeBuilder SetFault(Soap12FaultCode code, <span style="color:#66d9ef">string</span> subCode, <span style="color:#66d9ef">string</span> reason);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>ISoap12EnvelopeBuilder SetFault(Soap12FaultCode code, XNamespace subCodeNamespace, <span style="color:#66d9ef">string</span> subCode, <span style="color:#66d9ef">string</span> reason);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>ISoap12EnvelopeBuilder SetFault(Soap12FaultCode code, XNamespace subCodeNamespace, <span style="color:#66d9ef">string</span> subCode, <span style="color:#66d9ef">string</span> reason, <span style="color:#66d9ef">string</span> reasonXmlLanguage);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>ISoap12EnvelopeBuilder SetFault(Soap12FaultCode code, XNamespace subCodeNamespace, <span style="color:#66d9ef">string</span> subCode, <span style="color:#66d9ef">string</span> reason, <span style="color:#66d9ef">string</span> reasonXmlLanguage, <span style="color:#66d9ef">string</span> node);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>ISoap12EnvelopeBuilder SetFault(Soap12FaultCode code, XNamespace subCodeNamespace, <span style="color:#66d9ef">string</span> subCode, <span style="color:#66d9ef">string</span> reason, <span style="color:#66d9ef">string</span> reasonXmlLanguage, <span style="color:#66d9ef">string</span> node, <span style="color:#66d9ef">string</span> role);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>ISoap12EnvelopeBuilder SetFault(Soap12FaultCode code, XNamespace subCodeNamespace, <span style="color:#66d9ef">string</span> subCode, <span style="color:#66d9ef">string</span> reason, IEnumerable&lt;XContainer&gt; detailEntries);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>ISoap12EnvelopeBuilder SetFault(Soap12FaultCode code, XNamespace subCodeNamespace, <span style="color:#66d9ef">string</span> subCode, <span style="color:#66d9ef">string</span> reason, <span style="color:#66d9ef">string</span> reasonXmlLanguage, IEnumerable&lt;XContainer&gt; detailEntries);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>ISoap12EnvelopeBuilder SetFault(Soap12FaultCode code, XNamespace subCodeNamespace, <span style="color:#66d9ef">string</span> subCode, <span style="color:#66d9ef">string</span> reason, <span style="color:#66d9ef">string</span> reasonXmlLanguage, <span style="color:#66d9ef">string</span> node, <span style="color:#66d9ef">string</span> role, IEnumerable&lt;XContainer&gt; detailEntries);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>ISoap12EnvelopeBuilder SetStandardSoapEncoding();
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>ISoap12EnvelopeBuilder SetCustomSoapEncoding(<span style="color:#66d9ef">string</span> soapEncodingNamespace);
</code></pre></div>
        
        </div>

        
        <div class="content-page-tags">
            
            <a href="https://devzone.channeladam.com/tags/soap-1.1/">SOAP 1.1</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/soap-1.2/">SOAP 1.2</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/fluent/">Fluent</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/library/">Library</a>&nbsp;
            
        </div>
        

    </article>
    
    <article class="content-page-preview">
        <a href="https://devzone.channeladam.com/library/channeladam-core/">
            <h2 class="post-title">The ChannelAdam Core Library</h2>
        </a>

        <div class="content-page-entry">
        
            <h1 id="important-deprecation-notice">IMPORTANT: DEPRECATION NOTICE</h1>
<p><strong>This full .NET Framework library has been deprecated.</strong></p>
<p>The functionality has been refactored out into the following ChannelAdam .NET Standard libraries.</p>
<ul>
<li><a href="/library/channeladam-commands">ChannelAdam Commands Library</a></li>
<li><a href="/library/channeladam-dispatchproxies">ChannelAdam Dispatch Proxies Library</a></li>
<li><a href="/library/channeladam-disposing">ChannelAdam Disposing Library</a></li>
<li><a href="/library/channeladam-logging">ChannelAdam Logging Library</a></li>
<li><a href="/library/channeladam-primitiveextensions">ChannelAdam Primitive Extensions Library</a></li>
<li><a href="/library/channeladam-reflection">ChannelAdam Reflection Library</a></li>
<li><a href="/library/channeladam-transientfaulthandling">ChannelAdam Transient Fault Handling Library</a></li>
<li><a href="/library/channeladam-weakevents">ChannelAdam Weak Events Library</a></li>
<li><a href="/library/channeladam-xml">ChannelAdam XML Library</a></li>
</ul>
<h1 id="overview">Overview</h1>
<p>The open source, full .NET Framework, ChannelAdam Core Library provides some helpful .NET functionality - such as the implementation of various design patterns.
This functionality also just happens to be used in the other ChannelAdam code libraries&hellip;</p>
<p>Below are the main features of the library. See the linked code for details.</p>
<p>Please contact me if you have any questions.</p>
<h1 id="getting-started">Getting Started</h1>
<h2 id="nuget-package-installation">NuGet Package Installation</h2>
<p>To install the <a href="https://www.nuget.org/packages/ChannelAdam.Core" target="_blank">ChannelAdam.Core NuGet package</a>
run the following command in the Package Manager Console:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>PM&gt; Install-Package ChannelAdam.Core
</code></pre></div><h1 id="features">Features</h1>
<h2 id="disposable-pattern">Disposable Pattern</h2>
<p>Have you ever thought that the disposable pattern was complicated to implement or understand?
Inherit this and it&rsquo;s easy!</p>
<ul>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Disposable.cs" target="_blank">Disposable base class</a></li>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/DisposableWithDestructor.cs" target="_blank">Disposable base class with a Destructor</a></li>
</ul>
<h2 id="command-pattern">Command Pattern</h2>
<p>Have you ever needed to implement a <a href="http://www.oodesign.com/command-pattern.html" target="_blank">Command Pattern</a>?</p>
<h3 id="command-action">Command Action</h3>
<p>A Command Action has an <code>Execute</code> method with a <code>void</code> return parameter.</p>
<ul>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Commands/Abstractions/ICommand.cs" target="_blank">Command Action interface</a></li>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Commands/CommandBase.cs" target="_blank">Command Action base class</a></li>
</ul>
<h3 id="command-function">Command Function</h3>
<p>A Command Function has an <code>Execute</code> method with a specified return parameter.</p>
<ul>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Commands/Abstractions/ICommandFunction.cs" target="_blank">Command Function interface</a></li>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Commands/CommandFunctionBase.cs" target="_blank">Command Function base class</a></li>
</ul>
<h3 id="reversible-commands">Reversible Commands</h3>
<p>Need to execute some commands and be able to undo them? This Reversible Command implementation is for you!</p>
<p>Use the <a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Commands/ReversibleCommandManager.cs" target="_blank">Reversible Command Manager</a> to manage the stack of commands that can be reversed.</p>
<ul>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Commands/Abstractions/IReversibleCommand.cs" target="_blank">Reversible Command Action interface</a></li>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Commands/ReversibleCommandBase.cs" target="_blank">Reversible Command Action base class</a></li>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Commands/Abstractions/IReversibleCommandFunction.cs" target="_blank">Reversible Command Function interface</a></li>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Commands/ReversibleCommandFunctionBase.cs" target="_blank">Reversible Command Function base class</a></li>
</ul>
<h3 id="set-property---command-implementation">Set Property - Command Implementation</h3>
<p>A command implementation for setting a property on an object.</p>
<ul>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Commands/SetPropertyCommand.cs" target="_blank">Set Property Command</a></li>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Commands/ReversibleSetPropertyCommand.cs" target="_blank">Reversible Set Property Command</a></li>
</ul>
<h2 id="weak-event-pattern">Weak Event Pattern</h2>
<p>Need a <a href="https://msdn.microsoft.com/en-us/library/aa970850%28v=vs.110%29.aspx?f=255&amp;MSPPError=-2147217396" target="_blank">Weak Event</a> in specific circumstances to prevent memory leaks in your event listeners?</p>
<ul>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Events/IWeakEvent.cs" target="_blank">Weak Event interface</a></li>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Events/WeakEvent.cs" target="_blank">Weak Event implementation</a></li>
</ul>
<h2 id="simple-logger">Simple Logger</h2>
<p>A very simple interface for logging or writing out to the console.</p>
<ul>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Logging/ISimpleLogger.cs" target="_blank">Simple Logger interface</a></li>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Logging/SimpleConsoleLogger.cs" target="_blank">Simple Logger implementation</a></li>
</ul>
<h2 id="embedded-resources">Embedded Resources</h2>
<p>Easily retreive embedded resources from their manifest resource stream.</p>
<ul>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Reflection/EmbeddedResource.cs" target="_blank">Embedded Resource helper</a></li>
</ul>
<h2 id="real-proxies">Real Proxies</h2>
<p>Getting low-level with a Real Proxy? These are disposable and have retry capability!</p>
<ul>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Runtime/Remoting/Proxies/DisposableRealProxy.cs" target="_blank">Disposable Real Proxy</a></li>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Runtime/Remoting/Proxies/DisposableObjectRealProxy.cs" target="_blank">Disposable Object Real Proxy</a></li>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Runtime/Remoting/Proxies/RetryEnabledDisposableObjectRealProxy.cs" target="_blank">Retry Enabled Disposable Object Real Proxy</a></li>
</ul>
<h2 id="retry-policies-for-transient-fault-handling">Retry Policies (for Transient Fault Handling)</h2>
<p>Some handy interfaces to describe retry policies.</p>
<ul>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/TransientFaultHandling/IRetryPolicyAction.cs" target="_blank">Retry Policy Action interface</a></li>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/TransientFaultHandling/IRetryPolicyActionAsync.cs" target="_blank">Async Retry Policy Action interface</a></li>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/TransientFaultHandling/IRetryPolicyFunction.cs" target="_blank">Retry Policy Function interface</a></li>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/TransientFaultHandling/IRetryPolicyFunctionAsync.cs" target="_blank">Async Retry Policy Function interface</a></li>
<li><a href="https://channeladamwcf.codeplex.com/SourceControl/latest#src/ChannelAdam.Wcf.Microsoft.Practices.TransientFaultHandling.Core/TransientFaultHandling/RetryPolicyAdapter.cs" target="_blank">Sample Retry Policy Adapter</a> for the Microsoft Transient Fault Handling library</li>
</ul>
<h2 id="xml">XML</h2>
<p>XML validation, serialisation and type conversion made easy.</p>
<ul>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Xml/XmlConversionExtensions.cs" target="_blank">Extension methods for converting XML to various types</a></li>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Xml/XmlSerialisationExtensions.cs" target="_blank">Extension methods for serialising XML</a></li>
<li><a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Xml/XmlValidator.cs" target="_blank">Validate XML against an XSD Schema</a></li>
</ul>

        
        </div>

        
        <div class="content-page-tags">
            
            <a href="https://devzone.channeladam.com/tags/disposable/">Disposable</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/command/">Command</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/pattern/">Pattern</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/reversible/">Reversible</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/weak/">Weak</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/events/">Events</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/embedded-resources/">Embedded Resources</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/real-proxies/">Real Proxies</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/retry/">Retry</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/xml/">XML</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/serialization/">Serialization</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/validation/">Validation</a>&nbsp;
            
        </div>
        

    </article>
    
    <article class="content-page-preview">
        <a href="https://devzone.channeladam.com/library/channeladam-testframeworks/">
            <h2 class="post-title">The ChannelAdam Test Framework Libraries</h2>
        </a>

        <div class="content-page-entry">
        
            <h1 id="important-deprecation-notice">IMPORTANT: DEPRECATION NOTICE</h1>
<p><strong>This documention is for Version 1 of these full .NET Framework libraries and it has been deprecated.</strong></p>
<p>Please see the [Version 2] documentation for the following ChannelAdam .NET Standard libraries.</p>
<ul>
<li><a href="/library/channeladam-testframework">ChannelAdam Test Framework Library</a></li>
<li><a href="/library/channeladam-testframework-biztalk">ChannelAdam Test Framework BizTalk Library</a></li>
<li><a href="/library/channeladam-testframework-moq">ChannelAdam Test Framework Moq Library</a></li>
<li><a href="/library/channeladam-testframework-mstest">ChannelAdam Test Framework MSTest Library</a></li>
<li><a href="/library/channeladam-testframework-mstestv2">ChannelAdam Test Framework MSTest V2 Library</a></li>
<li><a href="/library/channeladam-testframework-nunit">ChannelAdam Test Framework NUnit Library</a></li>
<li><a href="/library/channeladam-testframework-text">ChannelAdam Test Framework Text Library</a></li>
<li><a href="/library/channeladam-testframework-xml">ChannelAdam Test Framework XML Library</a></li>
</ul>
<h1 id="overview">Overview</h1>
<p>The open source ChannelAdam Test Framework Libraries are a set of automated testing libraries to make testing your .NET code easier.</p>
<p>There are currently 3 main libraries:</p>
<ul>
<li>The ChannelAdam Test Framework - the common test framework library without a dependency on any other test runner or library</li>
<li>The ChannelAdam Test Framework for MSTest - containing MSTest-specific implementations of interfaces in the common library</li>
<li><a href="/library/channeladam-testframework-biztalk">The ChannelAdam Test Framework for BizTalk</a> - containing functionality
specifically for testing Microsoft BizTalk artifacts.</li>
</ul>
<p>The ChannelAdam Test Framework Libraries are fully compatible with MSTest and .NET Framework 4.0 and above.</p>
<p>Note: I highly recommend using these libraries with <a href="/library/bdd-behaviour-specification-handbook">Behaviour-Driven Development</a> practices
and the usage of <a href="http://www.specflow.org" target="_blank">SpecFlow</a>.</p>
<h1 id="getting-started">Getting Started</h1>
<h2 id="nuget-package-installation">NuGet Package Installation</h2>
<p>The easiest way to get started is to install the library that suits your favourite test runner or test library.
Currently however there is only the MSTest implementation&hellip;</p>
<p>To install the <a href="https://www.nuget.org/packages/ChannelAdam.TestFramework.MSTest" target="_blank">ChannelAdam.TestFramework.MSTest NuGet package</a>
run the following command in the Package Manager Console:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>PM&gt; Install-Package ChannelAdam.TestFramework.MSTest
</code></pre></div><h1 id="features">Features</h1>
<h2 id="logger">Logger</h2>
<p>Logging useful information to the output of a test is extremely important.</p>
<p>The <a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Logging/ISimpleLogger.cs" target="_blank">ISimpleLogger interface</a>
in the <a href="/library/channeladam-core">ChannelAdam Core Library</a> provides a very simple interface with a simple <code>Log</code> method that is intended
for usage in scenarios such writing test output.</p>
<p>The <a href="https://github.com/channeladam/ChannelAdam.Core/tree/master/src/ChannelAdam.Core/Logging/SimpleConsoleLogger.cs" target="_blank">SimpleConsoleLogger class</a>
implements <code>ISimpleLogger</code> and is a thin wrapper around Console.WriteLine().</p>
<h2 id="log-and-then-assert">Log and then Assert</h2>
<p>I cannot emphasise enough how important it is to log useful to the output of a test.
Developers and analysts almost should be able to read the output of a test like a story.
Analysts especially should review the test outputs and be satisfied that the test was implemented correctly - almost as if they performed the test themselves.
Therefore, when an assertion is performed, we want the test output to actually tell us that an assertion is taking place and
provide a information about what is being asserted.</p>
<p>The <a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/ILogAsserter.cs" target="_blank">Log Asserter interface</a>
provides all the usual assertion methods that you are familiar with, and the first parameter of all of the methods is a string
that will be outputted to an <code>ISimpleLogger</code> (provided in the constructor) before performing the actual assertion.</p>
<p>This <a href="https://github.com/channeladam/ChannelAdam.TestFramework.MSTest/tree/master/src/ChannelAdam.TestFramework.MSTest/LogAssert.cs" target="_blank">LogAssert class</a>
is the MSTest implementation of the <code>Log Asserter</code> interface.</p>
<h2 id="test-easy-base-class-for-tests">Test Easy Base Class for Tests</h2>
<p>Logging, assertions and testing for exceptions are 3 of some fundamental features common to most automated test suites.
Wouldn&rsquo;t it be nice to be able to perform that functionality easily and keep your test code to a minimum?</p>
<p>The <a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/TestEasy.cs" target="_blank">TestEasy base class for tests</a>
provides those abilities.</p>
<p>This class provides the following helpful properties.</p>
<ul>
<li>
<p><code>ISimpleLogger Logger</code> - for logging to the test output</p>
</li>
<li>
<p><code>ILogAsserter LogAssert</code> - your handy-dandy log asserter</p>
</li>
<li>
<p><code>ExpectedExceptionDescriptor ExpectedException</code> - describes the exception that is expected to occur for a specific test case</p>
</li>
<li>
<p><code>Exception ActualException</code> - for storing the actual exception that occurred</p>
</li>
</ul>
<p>When the <code>ActualException</code> property is set, the details are automatically logged to the test output.</p>
<p><a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/TestEasy.cs" target="_blank">TestEasy</a>
also contains the following helpful methods:</p>
<ul>
<li>
<p><code>void Try(Action action)</code> - performs the given action and catches exceptions into <code>ActualException</code></p>
</li>
<li>
<p><code>void Try(Func&lt;Task&gt; action)</code> - performs the given asynchronous action that returns a Task, waits for it finish, and catches exceptions into <code>ActualException</code></p>
</li>
<li>
<p><code>void AssertNoExceptionOccurred()</code> - asserts that no <code>ActualException</code> exists/occurred</p>
</li>
<li>
<p><code>void AssertExpectedException(Type expectedExceptionType)</code> - asserts that type of the value of <code>ActualException</code> is the given expected type</p>
</li>
<li>
<p><code>void AssertExpectedException()</code> - asserts that the <code>ActualException</code> is equivalent to that described by the <code>ExpectedException</code> descriptor.
When the <code>ActualException</code> is an <code>System.AggregateException</code>, the assertion will pass if there is at least one inner exception equivalent to the <code>ExpectedException</code> descriptor.</p>
</li>
</ul>
<h3 id="expected-exception-descriptor">Expected Exception Descriptor</h3>
<p>The <code>ExpectedException</code> property is implemented by the
<a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/ExpectedExceptionDescriptor.cs" target="_blank">ExpectedExceptionDescriptor class</a>.
This class describes the exception that is expected to occur.</p>
<p>There are 2 properties in <code>ExpectedExceptionDescriptor</code> that are specifically used in the <code>AssertExpectedException()</code> method:</p>
<ul>
<li>
<p><code>string MessageShouldContainText</code> - which describes the substring that the <code>ActualException.Message</code> property should contain</p>
</li>
<li>
<p><code>Type ExpectedType</code> - which describes the <code>System.Type</code> that <code>ActualException</code> should be.</p>
</li>
</ul>
<p>Either or both of these properties can be set.
When set, the details are automatically logged to the test output.</p>
<h2 id="moq-test-fixture-base-class-for-tests">Moq Test Fixture Base Class for Tests</h2>
<p><a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/MoqTestFixture.cs" target="_blank">MoqTestFixture</a>
inherits all the goodies from <code>TestEasy</code> and also provides a <code>MyMockRepositoy</code> property to access the Moq <code>MockRepository</code>.</p>
<p>The default constructor automatically creates a Moq &ldquo;loose&rdquo; <code>MockRepository</code>, but that can be specified in an overload of the constructor.</p>
<h2 id="text-tester">Text Tester</h2>
<p>The <a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/Text/TextTester.cs" target="_blank">TextTester class</a>
is used in tests for asserting whether actual text is similar enough to the given expected text.</p>
<p>Under the covers, it uses the <a href="https://github.com/mmanela/diffplex" target="_blank">DiffPlex</a> open source library to identify differences.</p>
<p>The <code>TextTester</code> class has the following properties:</p>
<ul>
<li>
<p><code>string ActualText</code></p>
</li>
<li>
<p><code>string ExpectedText</code></p>
</li>
<li>
<p><code>DiffPaneModel Differences</code></p>
</li>
<li>
<p><code>Action&lt;DiffPaneModel&gt; TextDifferenceFilter</code> - a filter for the diff (see below)</p>
</li>
</ul>
<p>And the following methods:</p>
<ul>
<li>
<p><code>void ArrangeActualText(Assembly assembly, string resourceName)</code> - to arrange the actual text from an embedded resource in the given assembly</p>
</li>
<li>
<p><code>void ArrangeActualText(string text)</code> - to arrange the actual text from the given string</p>
</li>
<li>
<p><code>void ArrangeExpectedText(Assembly assembly, string resourceName)</code> - to arrange the expected text from an embedded resource in the given assembly</p>
</li>
<li>
<p><code>void ArrangeExpectedText(string text)</code> - to arrange the expected text from the given string</p>
</li>
<li>
<p><code>virtual void AssertActualTextEqualsExpectedText()</code> - to assert the actual text against the expected text</p>
</li>
<li>
<p><code>bool IsEqual()</code> - determines if the given actual and expected text is equivalent</p>
</li>
<li>
<p><code>virtual bool IsEqual(string expected, string actual)</code> - determines if the given actual and expected text is equivalent</p>
</li>
</ul>
<h3 id="filtering-text-differences">Filtering Text Differences</h3>
<p>The <code>TextTester</code> class provides 3 mechanisms for hooking into the
DiffPlex <a href="https://github.com/mmanela/diffplex/blob/master/DiffPlex/DiffBuilder/Model/DiffPaneModel.cs" target="_blank"><code>DiffPaneModel</code></a>
difference result, allowing you to manipulate it before a final decision is made as<br>
to whether or not the actual text is similar enough to the expected text.</p>
<ul>
<li>An event that is raised with the differences</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>    <span style="color:#75715e">/// &lt;summary&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// Occurs when a text difference is detected, allowing a listener to filter the differences and
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// change the Line[x].Type to ChangeType.UnChanged so that the difference is no longer treated as a difference.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;/summary&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;remarks&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// This event or the TextDifferenceFilter property can be used for this purpose.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;/remarks&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> EventHandler&lt;TextDifferenceDetectedEventArgs&gt; TextDifferenceDetectedEvent;
</code></pre></div><ul>
<li>An action delegate method that is called with the differences</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>    <span style="color:#75715e">/// &lt;summary&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// Gets or sets the Action delegate to be invoked when a text difference is detected, allowing differences to be filtered out by
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// changing the Line[x].Type to ChangeType.UnChanged - so that a difference is no longer treated as a difference.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;/summary&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;value&gt;The Action delegate.&lt;/value&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;remarks&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// This property or TextDifferenceDetectedEvent can be used for this purpose.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;/remarks&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> Action&lt;DiffPaneModel&gt; TextDifferenceFilter { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
</code></pre></div><ul>
<li>A virtual method that allows you to inherit from the tester class and override the differences when they are detected.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> OnTextDifferenceDetected(DiffPaneModel differences)
</code></pre></div><p>For a quick example, please see the Behaviour Specification for the
<a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework.BehaviourSpecs/TextTesting.feature" target="_blank">TextTester class</a>
and the associated<br>
<a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework.BehaviourSpecs/TextTestingUnitSteps.cs" target="_blank">text tester code</a></p>
<h2 id="xml-tester">XML Tester</h2>
<p>The <a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/Xml/XmlTester.cs" target="_blank">XmlTester class</a>
is used in tests for asserting whether the actual XML is similar enough to the given expected XML.</p>
<p>Under the covers, it uses the <a href="http://www.xmlunit.org" target="_blank">XMLUnit.NET</a> open source library to identify differences.</p>
<p>The <code>XMLTester</code> class has the following properties:</p>
<ul>
<li>
<p><code>XElement ActualXml</code></p>
</li>
<li>
<p><code>XElement ExpectedXml</code></p>
</li>
<li>
<p><code>Diff Differences</code></p>
</li>
</ul>
<p>And the following methods:</p>
<ul>
<li>
<p><code>void ArrangeActualXml(Assembly assembly, string resourceName)</code> - to arrange the actual XML from an embedded resource in the given assembly</p>
</li>
<li>
<p><code>void ArrangeActualXml(XElement xmlElement)</code> - to arrange the actual XML from a given XElement</p>
</li>
<li>
<p><code>void ArrangeActualXml(object valueToSerialise)</code> - to arrange the actual XML by serialising the given object</p>
</li>
<li>
<p><code>void ArrangeActualXml(object valueToSerialise, XmlRootAttribute xmlRootAttribute)</code> - to arrange the actual XML by serialising the given object and applying the given <code>XmlRootAttribute</code> during the serialisation</p>
</li>
<li>
<p><code>void ArrangeActualXml(object valueToSerialise, XmlAttributeOverrides xmlAttributeOverrides)</code> - to arrange the actual XML by serialising the given object and applying the given <code>XmlAttributeOverrides</code> during the serialisation</p>
</li>
<li>
<p><code>void ArrangeActualXml(string xmlValue)</code> - to arrange the actual XML from the given XML string</p>
</li>
<li>
<p><code>void ArrangeExpectedXml(Assembly assembly, string resourceName)</code> - to arrange the expected XML from an embedded resource in the given assembly</p>
</li>
<li>
<p><code>void ArrangeExpectedXml(XElement xmlElement)</code> - to arrange the expected XML from a given XElement</p>
</li>
<li>
<p><code>void ArrangeExpectedXml(object valueToSerialise)</code> - to arrange the expected XML by serialising the given object</p>
</li>
<li>
<p><code>void ArrangeExpectedXml(object valueToSerialise, XmlRootAttribute xmlRootAttribute)</code> - to arrange the expected XML by serialising the given object and applying the given <code>XmlRootAttribute</code> during the serialisation</p>
</li>
<li>
<p><code>void ArrangeExpectedXml(object valueToSerialise, XmlAttributeOverrides xmlAttributeOverrides)</code> - to arrange the expected XML by serialising the given object and applying the given <code>XmlAttributeOverrides</code> during the serialisation</p>
</li>
<li>
<p><code>void ArrangeExpectedXml(string xmlValue)</code> - to arrange the expected XML from the given XML string</p>
</li>
<li>
<p><code>virtual void AssertActualXmlEqualsExpectedXml()</code> - to assert the actual XML against the expected XML</p>
</li>
<li>
<p><code>virtual void AssertActualXmlEqualsExpectedXml(IXmlFilter xmlFilter)</code> - to assert the actual XML against the expected XML, ignoring items listed in the given <code>IXmlFilter</code> (see below)</p>
</li>
<li>
<p><code>bool IsEqual()</code> - determines if the given actual and expected XML is equivalent</p>
</li>
<li>
<p><code>bool IsEqual(XNode expected, XNode actual)</code> - determines if the given actual and expected XNode XML is equivalent</p>
</li>
<li>
<p><code>virtual bool IsEqual(XmlNode expected, XmlNode actual)</code> - determines if the given actual and expected XmlNode XML is equivalent</p>
</li>
</ul>
<h3 id="ignoring--filtering-xml-elements">Ignoring / Filtering XML Elements</h3>
<p>The <code>AssertActualXmlEqualsExpectedXml(IXmlFilter xmlFilter)</code> override allows you to specify an
<a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/Xml/Abstractions/IXmlFilter.cs" target="_blank"><code>IXmlFilter interface</code></a>
which allows you to specify a list of the local names of XML elements to ignore in comparisons, and/or a list of XPath expressions to ignore in comparisons.</p>
<h3 id="examples">Examples</h3>
<p>For a quick example, please see the Behaviour Specification for the
<a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework.BehaviourSpecs/XmlTesting.feature" target="_blank">XmlTester class</a>
and the
<a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework.BehaviourSpecs/XmlTestingUnitSteps.cs" target="_blank">XML tester code</a></p>
<h2 id="xml-filter">XML Filter</h2>
<p>The <a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/Xml/XmlFilter.cs" target="_blank"><code>XmlFilter class</code></a>
allows you to specify a list of the local names of XML elements to ignore in comparisons, and/or a list of XPath expressions to ignore in comparisons.</p>
<p>Two constructor methods allow you to easily specify these lists.</p>
<ul>
<li>
<p><code>XmlFilter(IList&lt;string&gt; elementLocalNamesToIgnore)</code></p>
</li>
<li>
<p><code>XmlFilter(IList&lt;string&gt; elementLocalNamesToIgnore, IList&lt;string&gt; xpathsToIgnore)</code></p>
</li>
</ul>
<h2 id="xml-asserter">XML Asserter</h2>
<p>The <a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/Xml/XmlAsserter.cs" target="_blank"><code>XmlAsserter class</code></a>
provides utility methods for performing assertions on XML values.
It has the following methods:</p>
<ul>
<li>
<p><code>void XPathValueEquals(string description, string xpath, XNode rootElement, string expected)</code> - to assert that the given XPath of the provided XNode has the given expected string value</p>
</li>
<li>
<p><code>void XPathValueEquals(string description, string xpath, XNode rootElement, XmlNamespaceManager namespaceManager, string expected)</code> - uses the provided namespace manager to assert that the given XPath of the provided XNode has the given expected string value</p>
</li>
<li>
<p><code>void XPathValuesAreEqual(string description, string xpath, XNode expectedElements, XNode actualElements)</code> - to assert that the value of the XPath in the given actual XNode equals the corresponding value in the given expected XNode</p>
</li>
<li>
<p><code>void XPathValuesAreEqual(string description, string expectedXpath, XNode expectedElements, string actualXpath, XNode actualElements)</code> - to assert that the value of the actual XPath in the actual XNode is the same as the value of the expected XPath in the expected XNode</p>
</li>
<li>
<p><code>void XPathValuesAreEqual(string description, string expectedXpath, XNode expectedElements, XmlNamespaceManager expectedNamespaceManager, string actualXpath, XNode actualElements, XmlNamespaceManager actualNamespaceManager)</code> - to assert that the value of the actual XPath in the actual XNode is the same as the value of the expected XPath in the expected XNode, using the provided XML namespace managers</p>
</li>
<li>
<p><code>void AreEqual(XElement expectedXml, XElement actualXml)</code> - to assert that the given expected XElement is equivalent to the actual XElement</p>
</li>
<li>
<p><code>void AreEqual(XElement expectedXml, XElement actualXml, IXmlFilter xmlFilter)</code> - to assert that the given expected XElement is equivalent to the actual XElement - using the given <code>IXmlFilter</code></p>
</li>
</ul>
<h2 id="mapping-testers">Mapping Testers</h2>
<p>There are 4 map tester classes to be used depending on the type of input and output of your map:</p>
<ul>
<li>
<p><a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/Mapping/MappingFromXmlToXmlTester.cs" target="_blank"><code>MappingFromXmlToXmlTester class</code></a> - for testing a map that maps from XML to XML</p>
</li>
<li>
<p><a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/Mapping/MappingFromXmlToFlatFileTester.cs" target="_blank"><code>MappingFromXmlToFlatFileTester</code></a> - for testing a map that maps from XML to a flat file</p>
</li>
<li>
<p><a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/Mapping/MappingFromFlatFileToFlatFileTester.cs" target="_blank"><code>MappingFromFlatFileToFlatFileTester</code></a> - for testing a map that maps from a flat file to a flat file</p>
</li>
<li>
<p><a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/Mapping/MappingFromFlatFileToXmlTester.cs" target="_blank"><code>MappingFromFlatFileToXmlTester</code></a> - for testing a map that maps from a flat file to XML</p>
</li>
</ul>
<p>The <a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/Mapping/MappingFromXmlToXmlTester.cs" target="_blank"><code>MappingFromXmlToXmlTester class</code></a>
has the following method overrides for arranging the input XML.</p>
<ul>
<li>
<p><code>void ArrangeInputXml(Assembly assembly, string resourceName)</code> - to arrange the input XML from an embedded resource in the given assembly</p>
</li>
<li>
<p><code>void ArrangeInputXml(XElement xmlElement)</code> - to arrange the input XML from a given XElement</p>
</li>
<li>
<p><code>void ArrangeInputXml(object valueToSerialise)</code> - to arrange the input XML by serialising the given object</p>
</li>
<li>
<p><code>void ArrangeInputXml(object valueToSerialise, XmlRootAttribute xmlRootAttribute)</code> - to arrange the input XML by serialising the given object and applying the given <code>XmlRootAttribute</code> during the serialisation</p>
</li>
<li>
<p><code>void ArrangeInputXml(object valueToSerialise, XmlAttributeOverrides xmlAttributeOverrides)</code> - to arrange the input XML by serialising the given object and applying the given <code>XmlAttributeOverrides</code> during the serialisation</p>
</li>
<li>
<p><code>void ArrangeInputXml(string xmlValue)</code> - to arrange the input XML from the given XML string</p>
</li>
<li>
<p><code>void ArrangeExpectedOutputXml(Assembly assembly, string resourceName)</code> - to arrange the expected output XML from an embedded resource in the given assembly</p>
</li>
<li>
<p><code>void ArrangeExpectedOutputXml(XElement xmlElement)</code> - to arrange the expected output XML from a given XElement</p>
</li>
<li>
<p><code>void ArrangeExpectedOutputXml(object valueToSerialise)</code> - to arrange the expected output XML by serialising the given object</p>
</li>
<li>
<p><code>void ArrangeExpectedOutputXml(object valueToSerialise, XmlRootAttribute xmlRootAttribute)</code> - to arrange the expected output XML by serialising the given object and applying the given <code>XmlRootAttribute</code> during the serialisation</p>
</li>
<li>
<p><code>void ArrangeExpectedOutputXml(object valueToSerialise, XmlAttributeOverrides xmlAttributeOverrides)</code> - to arrange the expected output XML by serialising the given object and applying the given <code>XmlAttributeOverrides</code> during the serialisation</p>
</li>
<li>
<p><code>void ArrangeExpectedOutputXml(string xmlValue)</code> - to arrange the expected output XML from the given XML string</p>
</li>
</ul>
<p>Input can be arranged from an embedded resource, XElement, object that is XML serialisable (for which you can also override the root XML namespace when serialised) or simply a string.</p>
<p>This same pattern is followed for arranging the expected output of the map, and for arranging the contents of flat files with the other map tester classes.</p>
<h3 id="assert---compare-the-actual-output-against-the-expected-output">Assert - Compare the Actual Output Against the Expected Output</h3>
<p>The <a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/Mapping/MappingFromXmlToXmlTester.cs" target="_blank"><code>MappingFromXmlToXmlTester class</code></a>
has the following method overrides for asserting the actual output from the map against the expected output that was arranged.</p>
<ul>
<li>
<p><code>void AssertActualOutputXmlEqualsExpectedOutputXml()</code></p>
</li>
<li>
<p><code>AssertActualOutputXmlEqualsExpectedOutputXml(IXmlFilter xmlFilter)</code> (see below)</p>
</li>
</ul>
<p>All the comparison and logging and formatting of any differences is done for you. Easy!</p>
<h4 id="ignoring--filtering-xml-elements-1">Ignoring / Filtering XML Elements</h4>
<p>The <code>AssertActualOutputXmlEqualsExpectedOutputXml(IXmlFilter xmlFilter)</code> override allows you to specify an
<a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/Xml/Abstractions/IXmlFilter.cs" target="_blank"><code>IXmlFilter</code></a>
which allows you to specify a list of the local names of XML elements to ignore in comparisons, and/or a list of XPath expressions to ignore in comparisons.</p>
<p>Two constructor methods on <a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/tree/master/src/ChannelAdam.TestFramework/Xml/XmlFilter.cs" target="_blank"><code>XmlFilter</code></a>
allow you to easily specify these lists.</p>
<ul>
<li>
<p><code>XmlFilter(IList&lt;string&gt; elementLocalNamesToIgnore)</code></p>
</li>
<li>
<p><code>XmlFilter(IList&lt;string&gt; elementLocalNamesToIgnore, IList&lt;string&gt; xpathsToIgnore)</code></p>
</li>
</ul>
<h4 id="ignoring--filtering-flat-file-differences">Ignoring / Filtering Flat File Differences</h4>
<p>Ignoring differences in flat files is a little more tricky, but not too difficult.
The ChannelAdam library uses the <a href="https://github.com/mmanela/diffplex" target="_blank">DiffPlex</a> library for performing text differences.</p>
<p>3 mechanisms on the flat file tester classes are provided for hooking into the <a href="https://github.com/mmanela/diffplex/blob/master/DiffPlex/DiffBuilder/Model/DiffPaneModel.cs" target="_blank"><code>DiffPaneModel</code></a>
difference result and manipulating it before a final decision is made as
to whether or not the actual output is similar enough to the expected output.</p>
<ul>
<li>An event that is raised with the differences</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>    <span style="color:#75715e">/// &lt;summary&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// Occurs when a text difference is detected, allowing a listener to filter the differences and
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// change the Line[x].Type to ChangeType.UnChanged so that the difference is no longer treated as a difference.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;/summary&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;remarks&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// This event or the TextDifferenceFilter property can be used for this purpose.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;/remarks&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> EventHandler&lt;TextDifferenceDetectedEventArgs&gt; TextDifferenceDetectedEvent;
</code></pre></div><ul>
<li>An action delegate method that is called with the differences</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>    <span style="color:#75715e">/// &lt;summary&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// Gets or sets the Action delegate to be invoked when a text difference is detected, allowing differences to be filtered out by
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// changing the Line[x].Type to ChangeType.UnChanged - so that a difference is no longer treated as a difference.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;/summary&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;value&gt;The Action delegate.&lt;/value&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;remarks&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// This property or TextDifferenceDetectedEvent can be used for this purpose.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;/remarks&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> Action&lt;DiffPaneModel&gt; TextDifferenceFilter { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
</code></pre></div><ul>
<li>A virtual method that allows you to inherit from the tester class and override the differences when they are detected.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> OnTextDifferenceDetected(DiffPaneModel differences)
</code></pre></div>
        
        </div>

        
        <div class="content-page-tags">
            
            <a href="https://devzone.channeladam.com/tags/testing/">Testing</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/mstest/">MSTest</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/nunit/">NUnit</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/moq/">Moq</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/maps/">Maps</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/mapping/">Mapping</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/library/">Library</a>&nbsp;
            
        </div>
        

    </article>
    
    <article class="content-page-preview">
        <a href="https://devzone.channeladam.com/library/channeladam-testframework-biztalk/">
            <h2 class="post-title">The ChannelAdam Test Framework Library for BizTalk</h2>
        </a>

        <div class="content-page-entry">
        
            <h1 id="overview">Overview</h1>
<p>This is an <a href="https://github.com/channeladam/ChannelAdam.TestFramework.BizTalk" target="_blank">open source</a> .NET Framework 4.0, 4.5, 4.6 library providing functionality for the automated testing of BizTalk 2010/2013/2016 artifacts.</p>
<p>It provides you with an enhanced ability to use modern standard industry testing practices to test BizTalk Maps.</p>
<p>This library is compatible with the legacy, full .NET Framework 4.0 <a href="/library/channeladam-testframeworks">ChannelAdam Test Framework Libraries</a> (version 1) only.</p>
<p>Please see the article <a href="/articles/2016/10/modern-testing-of-biztalk-maps">Modern Testing of BizTalk Maps</a>
for background information on the issues with using Microsoft&rsquo;s out-of-the-box functionality for testing Microsoft BizTalk Maps.</p>
<p>This library provides the following benefits and features:</p>
<ul>
<li>Works with BizTalk 2010 / 2013 / 2016</li>
<li>Never again set the project property &ldquo;Enable Unit Testing&rdquo; to &ldquo;True&rdquo;!</li>
<li>BizTalk Map unit tests can be executed against a release build</li>
<li>The provided map tester classes allow you to easily unit test both XML and flat file BizTalk Maps</li>
<li>The design of tester classes follow the clean <a href="http://xp123.com/articles/3a-arrange-act-assert" target="_blank">Arrange-Act-Assert (AAA)</a> testing pattern</li>
<li>Support for arranging the input and expected output from a string, XElement, an XML serialisable object or loading from an embedded resource</li>
<li>Performs schema validation of both the input and output by default (easily overridable)</li>
<li>Support for mocking External Assembly class methods</li>
<li>Support for filtering assertions of the expected output to allow for dynamic data (such as timestamps or GUIDs)</li>
<li>Detailed information is provided allowing you to see the differences between the expected output and the actual output of the map.</li>
</ul>
<p>The ChannelAdam Test Framework Libraries are fully compatible with MSTest (v1) and .NET Framework 4.0, 4.5, 4.6.</p>
<p>Note: I highly recommend using <a href="/library/bdd-behaviour-specification-handbook">Behaviour-Driven Development</a> practices and the usage of <a href="http://www.specflow.org" target="_blank">SpecFlow</a> in conjunction with this library.</p>
<h1 id="getting-started">Getting Started</h1>
<h2 id="nuget-package-installation">NuGet Package Installation</h2>
<p>To install the <a href="https://www.nuget.org/packages/ChannelAdam.TestFramework.BizTalk" target="_blank">ChannelAdam.TestFramework.BizTalk NuGet package</a>
run the following command in the Package Manager Console:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>PM&gt; Install-Package ChannelAdam.TestFramework.BizTalk
</code></pre></div><h1 id="usage">Usage</h1>
<h2 id="the-basics">The Basics</h2>
<p>There are 4 map tester classes to be used depending on the type of input and output of your map:</p>
<ul>
<li><code>BizTalkXmlToXmlMapTester</code> - for testing a map that maps from XML to XML</li>
<li><code>BizTalkXmlToFlatFileMapTester</code> - for testing a map that maps from XML to a flat file</li>
<li><code>BizTalkFlatFileToFlatFileMapTester</code> - for testing a map that maps from a flat file to a flat file</li>
<li><code>BizTalkFlatFileToXmlMapTester</code> - for testing a map that maps from a flat file to XML</li>
</ul>
<p>Below is some sample MSTest test method code (in a very raw form) for testing a map that maps from XML to XML.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#75715e">// ==================
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#75715e">// Variables
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span style="color:#75715e">// ==================
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#75715e"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#75715e">// Define some helpful variables for our testing artifacts
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#75715e"></span><span style="color:#66d9ef">static</span> Assembly thisAssembly = <span style="color:#66d9ef">this</span>.GetType().Assembly;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span> inputXmlTestDataEmbeddedResourceName          = thisAssembly.GetName().Name + <span style="color:#e6db74">&#34;.InputXmlTestDataEmbeddedResource.xml&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span> expectedOutputXmlTestDataEmbeddedResourceName = thisAssembly.GetName().Name + <span style="color:#e6db74">&#34;.ExpectedOutputXmlTestDataEmbeddedResource.xml&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span style="color:#75715e">// Create the MSTest compatible logging assertion class
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> logAssert = <span style="color:#66d9ef">new</span> ChannelAdam.TestFramework.MSTest.LogAssert();
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#75715e">// Create the map tester - in this case for a map from XML to XML
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> xmlToXmlMapTester = <span style="color:#66d9ef">new</span> BizTalkXmlToXmlMapTester(logAssert);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#75715e">// ==================
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#75715e">// Arrange
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#75715e">// ==================
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#75715e"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span style="color:#75715e">// Arrange the input XML and expected output XML from embedded resources
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span style="color:#75715e"></span>xmlToXmlMapTester.ArrangeInputXml(thisAssembly, inputXmlTestDataEmbeddedResourceName);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>xmlToXmlMapTester.ArrangeExpectedOutputXml(thisAssembly, expectedOutputXmlTestDataEmbeddedResourceName);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span style="color:#75715e">// ==================
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span style="color:#75715e">// Act
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span style="color:#75715e">// ==================
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span style="color:#75715e"></span>xmlToXmlMapTester.TestMap(<span style="color:#66d9ef">new</span> MySpiffyMapFromXmlToXml());
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span style="color:#75715e">// ==================
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span style="color:#75715e">// Assert
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span style="color:#75715e">// ==================
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span style="color:#75715e"></span>xmlToXmlMapTester.AssertActualOutputXmlEqualsExpectedOutputXml();
</code></pre></div><p>Note: I highly recommend using the <a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/blob/master/src/ChannelAdam.TestFramework.MSTest/MoqTestFixture.cs" target="_blank">MoqTestFixture</a> as a base class to your test class as it removes the need for you to be concerned with instantiating the LogAssert class and provdes a number of base methods to make testing easier.
Please see the <a href="/library/channeladam-testframeworks">ChannelAdam Test Framework Libraries</a> documentation for more information.</p>
<p>The test code above results in the following test output.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>10/10/16 10:00:00 PM - The input XML for the map is: 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>&lt;ns0:Request xmlns:ns0=&#34;http://SampleBizTalkMaps.Schemas.XmlRequest&#34;&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>  &lt;Key&gt;Key_0&lt;/Key&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>  &lt;StringValue&gt;StringValue_0&lt;/StringValue&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>  &lt;DateTimeValue&gt;1999-05-31T13:20:00.000-05:00&lt;/DateTimeValue&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>  &lt;IntegerValue&gt;100&lt;/IntegerValue&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>  &lt;DecimalValue&gt;10.4&lt;/DecimalValue&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>&lt;/ns0:Request&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>10/10/16 10:00:00 PM - The expected output XML of the map is: 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>&lt;ns0:Response xmlns:ns0=&#34;http://SampleBizTalkMaps.Schemas.XmlResponse&#34;&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>  &lt;Key&gt;Key_0&lt;/Key&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>  &lt;StringValue&gt;StringValue_0FAKE_GUID&lt;/StringValue&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>  &lt;DateTimeValue&gt;1999-05-31T13:20:00.000-05:00&lt;/DateTimeValue&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>  &lt;IntegerValue&gt;100&lt;/IntegerValue&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>  &lt;DecimalValue&gt;10.4&lt;/DecimalValue&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>&lt;/ns0:Response&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>10/10/16 10:00:00 PM - Validating the input XML for the BizTalk map
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>10/10/16 10:00:00 PM - Executing the BizTalk map (XML to XML) MySpiffyMapFromXmlToXml
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>10/10/16 10:00:00 PM - Asserting XML output from the BizTalk map exists is True
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>10/10/16 10:00:00 PM - BizTalk map (XML to XML) execution completed
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>10/10/16 10:00:00 PM - The actual output XML from the map is: 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>&lt;ns0:Response xmlns:ns0=&#34;http://SampleBizTalkMaps.Schemas.XmlResponse&#34;&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>  &lt;Key&gt;Key_0&lt;/Key&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>  &lt;StringValue&gt;StringValue_0FAKE_GUID&lt;/StringValue&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>  &lt;DateTimeValue&gt;1999-05-31T13:20:00.000-05:00&lt;/DateTimeValue&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>  &lt;IntegerValue&gt;100&lt;/IntegerValue&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>  &lt;DecimalValue&gt;10.4&lt;/DecimalValue&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>&lt;/ns0:Response&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span>10/10/16 10:00:00 PM - Validating the output XML from the BizTalk map
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span>10/10/16 10:00:00 PM - Asserting actual and expected XML are equal
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span>10/10/16 10:00:00 PM - Asserting The XML is as expected is True
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span>10/10/16 10:00:00 PM - The XML is as expected
</code></pre></div><p>And the test passed successfully!</p>
<h2 id="advanced-usage">Advanced Usage</h2>
<p>More advanced functionality can be performed with the overloads on the methods used in the above test code.</p>
<h3 id="arrange---input-and-expected-output">Arrange - Input and Expected Output</h3>
<p>The <a href="https://github.com/channeladam/ChannelAdam.TestFramework.BizTalk/blob/master/src/ChannelAdam.TestFramework.BizTalk/BizTalkXmlToXmlMapTester.cs" target="_blank">BizTalkXmlToXmlMapTester</a>
has the following method overrides for arranging the input XML.</p>
<ul>
<li><code>void ArrangeInputXml(Assembly assembly, string resourceName)</code> - to arrange the input XML from an embedded resource in the given assembly</li>
<li><code>void ArrangeInputXml(XElement xmlElement)</code> - to arrange the input XML from a given XElement</li>
<li><code>void ArrangeInputXml(object valueToSerialise)</code> - to arrange the input XML by serialising the given object</li>
<li><code>void ArrangeInputXml(object valueToSerialise, XmlRootAttribute xmlRootAttribute)</code> - to arrange the input XML by serialising the given object and applying the given <code>XmlRootAttribute</code> during the serialisation</li>
<li><code>void ArrangeInputXml(object valueToSerialise, XmlAttributeOverrides xmlAttributeOverrides)</code> - to arrange the input XML by serialising the given object and applying the given <code>XmlAttributeOverrides</code> during the serialisation</li>
<li><code>void ArrangeInputXml(string xmlValue)</code> - to arrange the input XML from the given XML string</li>
</ul>
<p>Input can be arranged from an embedded resource, XElement, object that is XML serialisable (for which you can also override the root XML namespace when serialised) or simply a string.</p>
<p>This same pattern is followed for arranging the expected output of the map, and for arranging the contents of flat files with the other map tester classes.</p>
<h3 id="act---test-the-map">Act - Test the Map</h3>
<p>The <a href="https://github.com/channeladam/ChannelAdam.TestFramework.BizTalk/blob/master/src/ChannelAdam.TestFramework.BizTalk/BizTalkXmlToXmlMapTester.cs" target="_blank">BizTalkXmlToXmlMapTester</a>
has the following method overrides for testing your BizTalk Map.</p>
<ul>
<li><code>void TestMap(TransformBase map)</code></li>
<li><code>void TestMap(TransformBase map, IEnumerable&lt;XsltExtensionObjectDescriptor&gt; xsltExtensionObjectOverrides)</code> (see below - Mocking External Assemblies)</li>
<li><code>void TestMap(TransformBase map, bool validateInputXml, bool validateOutputXml)</code></li>
<li><code>void TestMap(TransformBase map, IEnumerable&lt;XsltExtensionObjectDescriptor&gt; xsltExtensionObjectOverrides, bool validateInput, bool validateOutputXml)</code></li>
</ul>
<p>The validateInputXml and validateOutputXml parameters are self-explanatory.</p>
<h4 id="mocking-external-assemblies">Mocking External Assemblies</h4>
<p>The xsltExtensionObjectOverrides enumerable is the secret to mocking External Assembly class methods.
To mock a class, create an Interface that define the method used in the map, and then create and set up a mock object from the Interface.
Then use the following code to create the xsltExtensionObjectOverrides, populated with the mock object.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#75715e">// Mock the external assembly &#39;MyExternalAssemblyClassUsedInTheMap&#39; class used in the map ;)
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> mocksOfExternalAssemblyClassesUsedInMap = <span style="color:#66d9ef">new</span> List&lt;XsltExtensionObjectDescriptor&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>    <span style="color:#66d9ef">new</span> XsltExtensionObjectDescriptor(<span style="color:#66d9ef">typeof</span>(MyExternalAssemblyClassUsedInTheMap), myMoqMockForThatClass.Object)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>};  
</code></pre></div><p>And test the map, providing the <code>xsltExtensionObjectOverrides</code> parameter.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#75715e">// Test the map which will execute methods on the mock objects
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span style="color:#75715e"></span>xmlToXmlMapTester.TestMap(<span style="color:#66d9ef">new</span> MySpiffyMapFromXmlToXml(), mocksOfExternalAssemblyClassesUsedInMap);
</code></pre></div><p>For Other examples, including how to mock an External Assembly, please refer to this example
<a href="https://github.com/channeladam/ChannelAdam.TestFramework.BizTalk/blob/master/src/ChannelAdam.TestFramework.BizTalk.BehaviourSpecs/BehaviourSpecs/BizTalkMapping.feature" target="_blank">BDD feature file</a>
and the <a href="https://github.com/channeladam/ChannelAdam.TestFramework.BizTalk/blob/master/src/ChannelAdam.TestFramework.BizTalk.BehaviourSpecs/BehaviourSpecs/BizTalkMappingUnitSteps.cs" target="_blank">implementation of the scenario steps</a>.</p>
<h3 id="assert---compare-the-actual-output-against-the-expected-output">Assert - Compare the Actual Output Against the Expected Output</h3>
<p>The <a href="https://github.com/channeladam/ChannelAdam.TestFramework.BizTalk/blob/master/src/ChannelAdam.TestFramework.BizTalk/BizTalkXmlToXmlMapTester.cs" target="_blank">BizTalkXmlToXmlMapTester</a>
has the following method overrides for asserting the actual output from the map against the expected output that was arranged.</p>
<ul>
<li><code>void AssertActualOutputXmlEqualsExpectedOutputXml()</code></li>
<li><code>AssertActualOutputXmlEqualsExpectedOutputXml(IXmlFilter xmlFilter)</code></li>
</ul>
<p>All the comparison and logging and formatting of any differences is done for you. Easy!</p>
<h4 id="ignoring--filtering-xml-elements">Ignoring / Filtering XML Elements</h4>
<p>The override allows you to specify an <a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/blob/master/src/ChannelAdam.TestFramework/Xml/Abstractions/IXmlFilter.cs" target="_blank"><code>IXmlFilter</code></a>
which allows you to specify a list of the local names of XML elements to ignore in comparisons, and/or a list of XPath expressions to ignore in comparisons.</p>
<p>Two constructor methods on <a href="https://github.com/channeladam/ChannelAdam.TestFrameworks/blob/master/src/ChannelAdam.TestFramework/Xml/XmlFilter.cs" target="_blank"><code>XmlFilter</code></a>
allow you to easily specify these lists.</p>
<ul>
<li><code>XmlFilter(IList&lt;string&gt; elementLocalNamesToIgnore)</code></li>
<li><code>XmlFilter(IList&lt;string&gt; elementLocalNamesToIgnore, IList&lt;string&gt; xpathsToIgnore)</code></li>
</ul>
<h4 id="ignoring--filtering-flat-file-differences">Ignoring / Filtering Flat File Differences</h4>
<p>Ignoring differences in flat files is a little more tricky, but not too difficult.
The ChannelAdam library uses the <a href="https://github.com/mmanela/diffplex" target="_blank">DiffPlex</a> library for performing text differences.</p>
<p>3 mechanisms on the flat file tester classes are provided for hooking into the <a href="https://github.com/mmanela/diffplex/blob/master/DiffPlex/DiffBuilder/Model/DiffPaneModel.cs" target="_blank"><code>DiffPaneModel</code></a>
difference result and manipulating it before a final decision is made as
to whether or not the actual output is similar enough to the expected output.</p>
<ul>
<li>An event that is raised with the differences</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>    <span style="color:#75715e">/// &lt;summary&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// Occurs when a text difference is detected, allowing a listener to filter the differences and
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// change the Line[x].Type to ChangeType.UnChanged so that the difference is no longer treated as a difference.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;/summary&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;remarks&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// This event or the TextDifferenceFilter property can be used for this purpose.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;/remarks&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">event</span> EventHandler&lt;TextDifferenceDetectedEventArgs&gt; TextDifferenceDetectedEvent;
</code></pre></div><ul>
<li>An action delegate method that is called with the differences</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>    <span style="color:#75715e">/// &lt;summary&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// Gets or sets the Action delegate to be invoked when a text difference is detected, allowing differences to be filtered out by
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// changing the Line[x].Type to ChangeType.UnChanged - so that a difference is no longer treated as a difference.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;/summary&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;value&gt;The Action delegate.&lt;/value&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;remarks&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// This property or TextDifferenceDetectedEvent can be used for this purpose.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;/remarks&gt;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> Action&lt;DiffPaneModel&gt; TextDifferenceFilter { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
</code></pre></div><ul>
<li>A virtual method that allows you to inherit from the tester class and override the differences when they are detected.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> OnTextDifferenceDetected(DiffPaneModel differences)
</code></pre></div>
        
        </div>

        
        <div class="content-page-tags">
            
            <a href="https://devzone.channeladam.com/tags/biztalk/">BizTalk</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/maps/">Maps</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/mapping/">Mapping</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/testing/">Testing</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/test-framework/">Test Framework</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/library/">Library</a>&nbsp;
            
        </div>
        

    </article>
    
    <article class="content-page-preview">
        <a href="https://devzone.channeladam.com/library/channeladam-wcf/v1/background/">
            <h2 class="post-title">Background</h2>
        </a>

        <div class="content-page-entry">
        
            <h1 id="channeladam-wcf-library-mdash-version-1-documentationlibrarychanneladam-wcfv1"><a href="/library/channeladam-wcf/v1">ChannelAdam WCF Library — Version 1 Documentation</a></h1>
<h2 id="background">Background</h2>
<h3 id="the-issues">The Issues</h3>
<p>The issues faced by .NET developers are explained in depth in the article <a href="/articles/2014/07/how-to-call-wcf-service-properly">How To Call WCF Services Properly</a>, where I researched and highlighted the typical problems with using WCF clients (such as memory and connection leaks), and concluded that the most correct solution for consuming WCF services would:</p>
<ul>
<li>Perform the Close/Abort pattern without a race condition;</li>
<li>Handle the situation when the service operation throws exceptions;</li>
<li>Handle the situations when both the <code>Close</code> and <code>Abort</code> methods throw exceptions; and</li>
<li>Handle asynchronous exceptions such as the <code>ThreadAbortException</code>.</li>
</ul>
<p>Below is the verbose sample code that is required for correctly using a .NET WCF client, performing exception handling and correctly performing the Close/Abort pattern.
Unfortunately, due to the way Microsoft designed WCF, if you want to use a WCF service client cleanly without connection or memory leaks, this is the type of extensive code that must be written for every service operation call.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1</span>SampleServiceClient client = <span style="color:#66d9ef">null</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3</span><span style="color:#66d9ef">try</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5</span>    client = <span style="color:#66d9ef">new</span> SampleServiceClient();
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7</span>    <span style="color:#66d9ef">var</span> response = client.SampleOperation(<span style="color:#ae81ff">1234</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9</span>    <span style="color:#75715e">// Do some business logic
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10</span><span style="color:#75715e"></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11</span><span style="color:#66d9ef">catch</span> (FaultException&lt;MyCustomException&gt;)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13</span>    <span style="color:#75715e">// Do some business logic for this SOAP Fault Exception
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14</span><span style="color:#75715e"></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15</span><span style="color:#66d9ef">catch</span> (FaultException)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17</span>    <span style="color:#75715e">// Do some business logic for this SOAP Fault Exception
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18</span><span style="color:#75715e"></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19</span><span style="color:#66d9ef">catch</span> (CommunicationException)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21</span>    <span style="color:#75715e">// Catch this expected exception so it is not propagated further.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22</span><span style="color:#75715e"></span>    <span style="color:#75715e">// Perhaps write this exception out to log file for gathering statistics...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23</span><span style="color:#75715e"></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24</span><span style="color:#66d9ef">catch</span> (TimeoutException)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26</span>    <span style="color:#75715e">// Catch this expected exception so it is not propagated further.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27</span><span style="color:#75715e"></span>    <span style="color:#75715e">// Perhaps write this exception out to log file for gathering statistics...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28</span><span style="color:#75715e"></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29</span><span style="color:#66d9ef">catch</span> (Exception)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31</span>    <span style="color:#75715e">// An unexpected exception that we don&#39;t know how to handle.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32</span><span style="color:#75715e"></span>    <span style="color:#75715e">// Perhaps write this exception out to log file for support purposes...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">throw</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35</span><span style="color:#66d9ef">finally</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37</span>    <span style="color:#75715e">// This will:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38</span><span style="color:#75715e"></span>    <span style="color:#75715e">// - be executed if any exception was thrown above in the &#39;try&#39; (including ThreadAbortException); and
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39</span><span style="color:#75715e"></span>    <span style="color:#75715e">// - ensure that CloseOrAbortServiceChannel() itself will not be interrupted by a ThreadAbortException
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40</span><span style="color:#75715e"></span>    <span style="color:#75715e">//   (since it is executing from within a &#39;finally&#39; block)
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41</span><span style="color:#75715e"></span>    CloseOrAbortServiceChannel(client);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43</span>    <span style="color:#75715e">// Unreference the client
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44</span><span style="color:#75715e"></span>    client = <span style="color:#66d9ef">null</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48</span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> CloseOrAbortServiceChannel(ICommunicationObject communicationObject)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50</span>    <span style="color:#66d9ef">bool</span> isClosed = <span style="color:#66d9ef">false</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52</span>    <span style="color:#66d9ef">if</span> (communicationObject == <span style="color:#66d9ef">null</span> || communicationObject.State == CommunicationState.Closed)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54</span>        <span style="color:#66d9ef">return</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57</span>    <span style="color:#66d9ef">try</span> 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59</span>        <span style="color:#66d9ef">if</span> (communicationObject.State != CommunicationState.Faulted)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60</span>        {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61</span>            communicationObject.Close();
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62</span>            isClosed = <span style="color:#66d9ef">true</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63</span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65</span>    <span style="color:#66d9ef">catch</span> (CommunicationException)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67</span>        <span style="color:#75715e">// Catch this expected exception so it is not propagated further.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68</span><span style="color:#75715e"></span>        <span style="color:#75715e">// Perhaps write this exception out to log file for gathering statistics...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69</span><span style="color:#75715e"></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70</span>    <span style="color:#66d9ef">catch</span> (TimeoutException)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72</span>        <span style="color:#75715e">// Catch this expected exception so it is not propagated further.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73</span><span style="color:#75715e"></span>        <span style="color:#75715e">// Perhaps write this exception out to log file for gathering statistics...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74</span><span style="color:#75715e"></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75</span>    <span style="color:#66d9ef">catch</span> (Exception)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77</span>        <span style="color:#75715e">// An unexpected exception that we don&#39;t know how to handle.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78</span><span style="color:#75715e"></span>        <span style="color:#75715e">// Perhaps write this exception out to log file for support purposes...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">throw</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81</span>    <span style="color:#66d9ef">finally</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83</span>        <span style="color:#75715e">// If State was Faulted or any exception occurred while doing the Close(), then do an Abort()
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> (!isClosed)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85</span>        {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86</span>            AbortServiceChannel(communicationObject);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87</span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92</span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> AbortServiceChannel(ICommunicationObject communicationObject)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94</span>    <span style="color:#66d9ef">try</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96</span>        communicationObject.Abort();
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98</span>    <span style="color:#66d9ef">catch</span> (Exception)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100</span>        <span style="color:#75715e">// An unexpected exception that we don&#39;t know how to handle.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101</span><span style="color:#75715e"></span>        <span style="color:#75715e">// If we are in this situation:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102</span><span style="color:#75715e"></span>        <span style="color:#75715e">// - we should NOT retry the Abort() because it has already failed and there is nothing to suggest it could be successful next time
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103</span><span style="color:#75715e"></span>        <span style="color:#75715e">// - the abort may have partially succeeded
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104</span><span style="color:#75715e"></span>        <span style="color:#75715e">// - the actual service call may have been successful
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105</span><span style="color:#75715e"></span>        <span style="color:#75715e">//
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">106</span><span style="color:#75715e"></span>        <span style="color:#75715e">// The only thing we can do is hope that the channel&#39;s resources have been released.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">107</span><span style="color:#75715e"></span>        <span style="color:#75715e">// Do not rethrow this exception because the actual service operation call might have succeeded
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">108</span><span style="color:#75715e"></span>        <span style="color:#75715e">// and an exception closing the channel should not stop the client doing whatever it does next.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">109</span><span style="color:#75715e"></span>        <span style="color:#75715e">//
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">110</span><span style="color:#75715e"></span>        <span style="color:#75715e">// Perhaps write this exception out to log file for gathering statistics and support purposes...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">111</span><span style="color:#75715e"></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">112</span>}
</code></pre></div><h3 id="channeladam-wcf-library-makes-it-easy">ChannelAdam WCF Library Makes It Easy</h3>
<p>The <em>ChannelAdam WCF Library</em> is an API for working with WCF clients, that significantly reduces the amount of that code that developers have to write.
It allows you to forget about the complex subtleties of WCF clients, channels and communication states, and lets you just use your service client in a way that is very similar to how you probably are doing it now - but without the leaks!</p>
<p>When you use the ChannelAdam WCF Library&rsquo;s <code>ServiceConsumer</code>, you know that you can keep calling service operations through the <code>ServiceConsumer</code> and it will &lsquo;just work&rsquo; and not leak connections or memory - no matter what happens!</p>
<p>The ChannelAdam WCF Library&rsquo;s <code>ServiceConsumer</code> hides the inner complexity of service channels.
For example, if a service channel / communication object / service client moves into a Fault state, the <code>ServiceConsumer</code> will correctly perform the Close/Abort pattern and dispose of the channel.
The next time a request is made through the <code>ServiceConsumer</code>, a new channel is created under the covers to seamlessly process the request.</p>

        
        </div>

        
        <div class="content-page-tags">
            
            <a href="https://devzone.channeladam.com/tags/wcf/">WCF</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/windows-communication-foundation/">Windows Communication Foundation</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/channeladam-.net-libraries/">ChannelAdam .NET Libraries</a>&nbsp;
            
        </div>
        

    </article>
    
    <article class="content-page-preview">
        <a href="https://devzone.channeladam.com/library/channeladam-wcf/v2/background/">
            <h2 class="post-title">Background</h2>
        </a>

        <div class="content-page-entry">
        
            <h1 id="channeladam-wcf-library-mdash-version-2-documentationlibrarychanneladam-wcfv2"><a href="/library/channeladam-wcf/v2">ChannelAdam WCF Library — Version 2 Documentation</a></h1>
<h2 id="background">Background</h2>
<h3 id="the-issues">The Issues</h3>
<p>The issues faced by .NET developers are explained in depth in the article <a href="/articles/2014/07/how-to-call-wcf-service-properly">How To Call WCF Services Properly</a>, where I researched and highlighted the typical problems with using WCF clients (such as memory and connection leaks), and concluded that the most correct solution for consuming WCF services would:</p>
<ul>
<li>Perform the Close/Abort pattern without a race condition;</li>
<li>Handle the situation when the service operation throws exceptions;</li>
<li>Handle the situations when both the <code>Close</code> and <code>Abort</code> methods throw exceptions; and</li>
<li>Handle asynchronous exceptions such as the <code>ThreadAbortException</code>.</li>
</ul>
<p>Below is the verbose sample code that is required for correctly using a .NET WCF client, performing exception handling and correctly performing the Close/Abort pattern.
Unfortunately, due to the way Microsoft designed WCF, if you want to use a WCF service client cleanly without connection or memory leaks, this is the type of extensive code that must be written for every service operation call.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1</span>SampleServiceClient client = <span style="color:#66d9ef">null</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3</span><span style="color:#66d9ef">try</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5</span>    client = <span style="color:#66d9ef">new</span> SampleServiceClient();
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7</span>    <span style="color:#66d9ef">var</span> response = client.SampleOperation(<span style="color:#ae81ff">1234</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9</span>    <span style="color:#75715e">// Do some business logic
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10</span><span style="color:#75715e"></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11</span><span style="color:#66d9ef">catch</span> (FaultException&lt;MyCustomException&gt;)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13</span>    <span style="color:#75715e">// Do some business logic for this SOAP Fault Exception
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14</span><span style="color:#75715e"></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15</span><span style="color:#66d9ef">catch</span> (FaultException)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17</span>    <span style="color:#75715e">// Do some business logic for this SOAP Fault Exception
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18</span><span style="color:#75715e"></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19</span><span style="color:#66d9ef">catch</span> (CommunicationException)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21</span>    <span style="color:#75715e">// Catch this expected exception so it is not propagated further.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22</span><span style="color:#75715e"></span>    <span style="color:#75715e">// Perhaps write this exception out to log file for gathering statistics...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23</span><span style="color:#75715e"></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24</span><span style="color:#66d9ef">catch</span> (TimeoutException)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26</span>    <span style="color:#75715e">// Catch this expected exception so it is not propagated further.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27</span><span style="color:#75715e"></span>    <span style="color:#75715e">// Perhaps write this exception out to log file for gathering statistics...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28</span><span style="color:#75715e"></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29</span><span style="color:#66d9ef">catch</span> (Exception)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31</span>    <span style="color:#75715e">// An unexpected exception that we don&#39;t know how to handle.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32</span><span style="color:#75715e"></span>    <span style="color:#75715e">// Perhaps write this exception out to log file for support purposes...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">throw</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35</span><span style="color:#66d9ef">finally</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37</span>    <span style="color:#75715e">// This will:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38</span><span style="color:#75715e"></span>    <span style="color:#75715e">// - be executed if any exception was thrown above in the &#39;try&#39; (including ThreadAbortException); and
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39</span><span style="color:#75715e"></span>    <span style="color:#75715e">// - ensure that CloseOrAbortServiceChannel() itself will not be interrupted by a ThreadAbortException
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40</span><span style="color:#75715e"></span>    <span style="color:#75715e">//   (since it is executing from within a &#39;finally&#39; block)
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41</span><span style="color:#75715e"></span>    CloseOrAbortServiceChannel(client);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43</span>    <span style="color:#75715e">// Unreference the client
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44</span><span style="color:#75715e"></span>    client = <span style="color:#66d9ef">null</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48</span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> CloseOrAbortServiceChannel(ICommunicationObject communicationObject)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50</span>    <span style="color:#66d9ef">bool</span> isClosed = <span style="color:#66d9ef">false</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52</span>    <span style="color:#66d9ef">if</span> (communicationObject == <span style="color:#66d9ef">null</span> || communicationObject.State == CommunicationState.Closed)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54</span>        <span style="color:#66d9ef">return</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57</span>    <span style="color:#66d9ef">try</span> 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59</span>        <span style="color:#66d9ef">if</span> (communicationObject.State != CommunicationState.Faulted)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60</span>        {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61</span>            communicationObject.Close();
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62</span>            isClosed = <span style="color:#66d9ef">true</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63</span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65</span>    <span style="color:#66d9ef">catch</span> (CommunicationException)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67</span>        <span style="color:#75715e">// Catch this expected exception so it is not propagated further.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68</span><span style="color:#75715e"></span>        <span style="color:#75715e">// Perhaps write this exception out to log file for gathering statistics...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69</span><span style="color:#75715e"></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70</span>    <span style="color:#66d9ef">catch</span> (TimeoutException)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72</span>        <span style="color:#75715e">// Catch this expected exception so it is not propagated further.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73</span><span style="color:#75715e"></span>        <span style="color:#75715e">// Perhaps write this exception out to log file for gathering statistics...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74</span><span style="color:#75715e"></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75</span>    <span style="color:#66d9ef">catch</span> (Exception)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77</span>        <span style="color:#75715e">// An unexpected exception that we don&#39;t know how to handle.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78</span><span style="color:#75715e"></span>        <span style="color:#75715e">// Perhaps write this exception out to log file for support purposes...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">throw</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81</span>    <span style="color:#66d9ef">finally</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83</span>        <span style="color:#75715e">// If State was Faulted or any exception occurred while doing the Close(), then do an Abort()
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> (!isClosed)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85</span>        {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86</span>            AbortServiceChannel(communicationObject);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87</span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92</span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> AbortServiceChannel(ICommunicationObject communicationObject)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94</span>    <span style="color:#66d9ef">try</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96</span>        communicationObject.Abort();
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98</span>    <span style="color:#66d9ef">catch</span> (Exception)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100</span>        <span style="color:#75715e">// An unexpected exception that we don&#39;t know how to handle.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101</span><span style="color:#75715e"></span>        <span style="color:#75715e">// If we are in this situation:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102</span><span style="color:#75715e"></span>        <span style="color:#75715e">// - we should NOT retry the Abort() because it has already failed and there is nothing to suggest it could be successful next time
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103</span><span style="color:#75715e"></span>        <span style="color:#75715e">// - the abort may have partially succeeded
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104</span><span style="color:#75715e"></span>        <span style="color:#75715e">// - the actual service call may have been successful
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105</span><span style="color:#75715e"></span>        <span style="color:#75715e">//
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">106</span><span style="color:#75715e"></span>        <span style="color:#75715e">// The only thing we can do is hope that the channel&#39;s resources have been released.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">107</span><span style="color:#75715e"></span>        <span style="color:#75715e">// Do not rethrow this exception because the actual service operation call might have succeeded
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">108</span><span style="color:#75715e"></span>        <span style="color:#75715e">// and an exception closing the channel should not stop the client doing whatever it does next.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">109</span><span style="color:#75715e"></span>        <span style="color:#75715e">//
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">110</span><span style="color:#75715e"></span>        <span style="color:#75715e">// Perhaps write this exception out to log file for gathering statistics and support purposes...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">111</span><span style="color:#75715e"></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">112</span>}
</code></pre></div><h3 id="channeladam-wcf-library-makes-it-easy">ChannelAdam WCF Library Makes It Easy</h3>
<p>The <em>ChannelAdam WCF Library</em> is an API for working with WCF clients, that significantly reduces the amount of that code that developers have to write.
It allows you to forget about the complex subtleties of WCF clients, channels and communication states, and lets you just use your service client in a way that is very similar to how you probably are doing it now - but without the leaks!</p>
<p>When you use the ChannelAdam WCF Library&rsquo;s <code>ServiceConsumer</code>, you know that you can keep calling service operations through the <code>ServiceConsumer</code> and it will &lsquo;just work&rsquo; and not leak connections or memory - no matter what happens!</p>
<p>The ChannelAdam WCF Library&rsquo;s <code>ServiceConsumer</code> hides the inner complexity of service channels.
For example, if a service channel / communication object / service client moves into a Fault state, the <code>ServiceConsumer</code> will correctly perform the Close/Abort pattern and dispose of the channel.
The next time a request is made through the <code>ServiceConsumer</code>, a new channel is created under the covers to seamlessly process the request.</p>

        
        </div>

        
        <div class="content-page-tags">
            
            <a href="https://devzone.channeladam.com/tags/wcf/">WCF</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/windows-communication-foundation/">Windows Communication Foundation</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/channeladam-.net-libraries/">ChannelAdam .NET Libraries</a>&nbsp;
            
        </div>
        

    </article>
    
    <article class="content-page-preview">
        <a href="https://devzone.channeladam.com/library/channeladam-wcf/v1/basic-usage/">
            <h2 class="post-title">Basic Usage</h2>
        </a>

        <div class="content-page-entry">
        
            <h1 id="channeladam-wcf-library-mdash-version-1-documentationlibrarychanneladam-wcfv1"><a href="/library/channeladam-wcf/v1">ChannelAdam WCF Library — Version 1 Documentation</a></h1>
<h2 id="basic-usage">Basic Usage</h2>
<h3 id="create-a-serviceconsumer-with-the-serviceconsumerfactory">Create a ServiceConsumer with the ServiceConsumerFactory</h3>
<p>The first thing you need to understand is that you consume your service operations through the usage of the <code>ChannelAdam.ServiceModel.ServiceConsumer</code> class.</p>
<p>The second thing you need to understand is that the best way to create the <code>ServiceConsumer</code> is by using the <code>Create</code> method on the <code>ChannelAdam.ServiceModel.ServiceConsumerFactory</code>.</p>
<p>In order to use the <code>ServiceConsumerFactory.Create</code> method, simply pass in as a parameter a factory method for creating the service client.</p>
<p>For example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>IServiceConsumer&lt;IFakeService&gt; service = ServiceConsumerFactory.Create&lt;IFakeService&gt;(() =&gt; <span style="color:#66d9ef">new</span> FakeServiceClient()));
</code></pre></div><p>The <code>ServiceConsumerFactory.Create</code> method returns a <code>IServiceConsumer&lt;TServiceInterface&gt;</code> type.
In all further examples, I will use the <code>var</code> keyword instead - such as:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#66d9ef">var</span> service = ServiceConsumerFactory.Create&lt;IFakeService&gt;(() =&gt; <span style="color:#66d9ef">new</span> FakeServiceClient()));
</code></pre></div><p>Alternatively, you can pass in as a string parameter the endpoint configuration name from the service client section of your application&rsquo;s .config file. For example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#66d9ef">var</span> service = ServiceConsumerFactory.Create&lt;IFakeService&gt;(<span style="color:#e6db74">&#34;BasicHttpBinding_IFakeService&#34;</span>)); 
</code></pre></div><h3 id="four-ways-to-clean-up-the-serviceconsumer">Four Ways to Clean Up the ServiceConsumer</h3>
<p>There are four ways in which the <code>ServiceConsumer</code> can be cleaned up:</p>
<ol>
<li>Implicitly via the Using statement;</li>
<li>Explicitly with the Close method;</li>
<li>Explicitly with the Dispose method; or</li>
<li>Automatically by the Garbage Collector.</li>
</ol>
<h4 id="1-the-using-statement">1. The Using Statement</h4>
<p>The recommended and easiest way to use the ServiceConsumer is with the <code>using</code> statement - because it is a well behaved implementation of <code>IDisposable</code> (unlike Microsoft&rsquo;s service clients!).
The service channel will automatically be correctly disposed and closed or aborted, no matter what happens.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#66d9ef">using</span> (<span style="color:#66d9ef">var</span> service = ServiceConsumerFactory.Create&lt;IFakeService&gt;(() =&gt; <span style="color:#66d9ef">new</span> FakeServiceClient())))
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>    ...
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>}
</code></pre></div><h4 id="2-the-close-method">2. The Close Method</h4>
<p>The <code>ServiceConsumer</code> and underlying channel can be closed immediately by calling the <code>Close</code> method on the <code>ServiceConsumer</code> instance.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>service.Close();
</code></pre></div><p>If you want to, you still can immediately call another service operation via that same <code>ServiceConsumer</code> instance, as under the covers, a new service channel will be created seamlessly and automatically.</p>
<h4 id="3-the-dispose-method">3. The Dispose Method</h4>
<p>The <code>ServiceConsumer</code> and underlying channel can be disposed of immediately by calling the <code>Dispose</code> method on the <code>ServiceConsumer</code> instance.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>service.Dispose();
</code></pre></div><p>As per standard <code>IDisposable</code> concepts, you should not attempt to reuse the <code>ServiceConsumer</code> after disposing it.</p>
<h4 id="4-garbage-collection">4. Garbage Collection</h4>
<p>If you happen to accidently forget to wrap your <code>ServiceConsumer</code> instance in a <code>Using</code> statement or call the <code>Close</code> method, rest assured that the <code>ServiceConsumer</code> will still be cleaned up! When the <code>ServiceConsumer</code> instance goes out of scope, the .NET Garbage Collector will [eventually] kick in and call its destructor/finalise method, thus correctly cleaning up the service channel and preventing any leaks.</p>
<p>Since there is an indeterminate amount of time before the Garbage Collector kicks in, I would recommend the <code>Using</code> statement approach, as it minimises the number of open channels and other resources currently in use, over the lifetime of your application.</p>
<h3 id="how-to-call-a-service-operation">How To Call a Service Operation</h3>
<p>There are two ways in which to call a service operation via the <code>ServiceConsumer</code>:</p>
<ol>
<li>Via the <code>Operations</code> property; or</li>
<li>Via the <code>Consume</code> method.</li>
</ol>
<h3 id="the-operations-property">The Operations Property</h3>
<p>The <code>Operations</code> property exposes the interface of your service. It can be used just like the normal service client that you already would be familiar with.</p>
<p>Below is an example of how to call the <code>AddIntegers</code> operation via the <code>Operations</code> property.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#66d9ef">using</span> (<span style="color:#66d9ef">var</span> service = ServiceConsumerFactory.Create&lt;IFakeService&gt;(() =&gt; <span style="color:#66d9ef">new</span> FakeServiceClient())))
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>    <span style="color:#66d9ef">try</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>        <span style="color:#66d9ef">int</span> actualValue = service.Operations.AddIntegers(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>        ...
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span>    ...
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9</span>}
</code></pre></div><p>And below is an example of how to do some exception handling with it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#66d9ef">using</span> (<span style="color:#66d9ef">var</span> service = ServiceConsumerFactory.Create&lt;IFakeService&gt;(() =&gt; <span style="color:#66d9ef">new</span> FakeServiceClient())))
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    <span style="color:#66d9ef">try</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>        <span style="color:#66d9ef">int</span> actualValue = service.Operations.AddIntegers(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>        ...
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    <span style="color:#66d9ef">catch</span> (FaultException&lt;MyCustomException&gt; fe)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>        Console.WriteLine(<span style="color:#e6db74">&#34;Service operation threw a custom fault: &#34;</span> + fe.ToString());
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    <span style="color:#66d9ef">catch</span> (FaultException fe)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>        Console.WriteLine(<span style="color:#e6db74">&#34;Service operation threw a fault: &#34;</span> + fe.ToString());
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>    <span style="color:#66d9ef">catch</span> (Exception ex)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>        Console.WriteLine(<span style="color:#e6db74">&#34;An unexpected error occurred while calling the service operation: &#34;</span> + ex.ToString());
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>}
</code></pre></div><p>There is no need to catch a <code>CommunicationException</code> or <code>TimeOutException</code> and try to perform the Close/Abort pattern, as the underlying channel is dealt with automatically for you by the <code>ServiceConsumer</code>.</p>
<h3 id="the-consume-method">The Consume Method</h3>
<p>As an alternative to the <code>Operations</code> property, you can call a service operation via the <code>Consume</code> method on the <code>ServiceConsumer</code> instance.</p>
<p>The <code>Consume</code> method returns an instance of <code>IOperationResult&lt;TReturnTypeOfYourOperation&gt;</code> which wraps the result of the operation. This interface has the following helpful properties:</p>
<ul>
<li><code>TReturnTypeOfYourOperation Value</code> - which gives you access to the return value from the operation;</li>
<li><code>bool HasException</code> - whether there was an exception thrown by the service operation;</li>
<li><code>bool HasNoException</code> - whether there was not an exception thrown by the service operation;</li>
<li><code>bool HasFaultException</code> - whether an exception of type <code>FaultException</code> was thrown by the service operation;</li>
<li><code>bool HasFaultException&lt;OfThisType&gt;</code> - whether an exception of <code>FaultException&lt;OfThisType&gt;</code> was thrown by the service operation; and</li>
<li><code>Exception Exception</code> - the exception that was thrown by the service operation.</li>
</ul>
<p>Below is an example of how to call the <code>AddIntegers</code> operation via the <code>Consume</code> method.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#66d9ef">using</span> (<span style="color:#66d9ef">var</span> service = ServiceConsumerFactory.Create&lt;IFakeService&gt;(() =&gt; <span style="color:#66d9ef">new</span> FakeServiceClient())))
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>	IOperationResult&lt;<span style="color:#66d9ef">int</span>&gt; result = service.Consume(operation =&gt; operation.AddIntegers(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    <span style="color:#66d9ef">if</span> (result.HasNoException)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        Console.WriteLine(<span style="color:#e6db74">&#34;Result was: &#34;</span> + result.Value);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>        ...
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    ...
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>}
</code></pre></div><p>And below is an example of how to do some exception handling with <code>IOperationResult</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#66d9ef">using</span> (<span style="color:#66d9ef">var</span> service = ServiceConsumerFactory.Create&lt;IFakeService&gt;(() =&gt; <span style="color:#66d9ef">new</span> FakeServiceClient())))
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    <span style="color:#66d9ef">var</span> result = service.Consume(operation =&gt; operation.AddIntegers(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    <span style="color:#66d9ef">if</span> (result.HasNoException)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        Console.WriteLine(<span style="color:#e6db74">&#34;Result was: &#34;</span> + result.Value);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    <span style="color:#66d9ef">else</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>        <span style="color:#66d9ef">if</span> (result.HasFaultExceptionOfType&lt;MyCustomException&gt;())
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>        {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>            Console.WriteLine(<span style="color:#e6db74">&#34;Service operation threw a custom fault: &#34;</span> + result.Exception.ToString());
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>        <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (result.HasFaultException)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>        {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>            Console.WriteLine(<span style="color:#e6db74">&#34;Service operation threw a fault: &#34;</span> + result.Exception.ToString());
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>        <span style="color:#66d9ef">else</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>        {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>            Console.WriteLine(<span style="color:#e6db74">&#34;An unexpected error occurred while calling the service operation: &#34;</span> + result.Exception.ToString());
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>}
</code></pre></div>
        
        </div>

        
        <div class="content-page-tags">
            
            <a href="https://devzone.channeladam.com/tags/wcf/">WCF</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/windows-communication-foundation/">Windows Communication Foundation</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/channeladam-.net-libraries/">ChannelAdam .NET Libraries</a>&nbsp;
            
        </div>
        

    </article>
    
    <article class="content-page-preview">
        <a href="https://devzone.channeladam.com/library/channeladam-wcf/v2/basic-usage/">
            <h2 class="post-title">Basic Usage</h2>
        </a>

        <div class="content-page-entry">
        
            <h1 id="channeladam-wcf-library-mdash-version-2-documentationlibrarychanneladam-wcfv2"><a href="/library/channeladam-wcf/v2">ChannelAdam WCF Library — Version 2 Documentation</a></h1>
<h2 id="basic-usage">Basic Usage</h2>
<h3 id="create-a-serviceconsumer-with-the-serviceconsumerfactory">Create a ServiceConsumer with the ServiceConsumerFactory</h3>
<p>The first thing you need to understand is that you consume your service operations through the usage of the <code>ChannelAdam.ServiceModel.ServiceConsumer</code> class.</p>
<p>The second thing you need to understand is that the best way to create the <code>ServiceConsumer</code> is by using the <code>Create</code> method on the <code>ChannelAdam.ServiceModel.ServiceConsumerFactory</code>.</p>
<p>In order to use the <code>ServiceConsumerFactory.Create</code> method, simply pass in as a parameter a factory method for creating the service client.</p>
<p>For example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>IServiceConsumer&lt;IFakeService&gt; service = ServiceConsumerFactory.Create&lt;IFakeService&gt;(() =&gt; <span style="color:#66d9ef">new</span> FakeServiceClient()));
</code></pre></div><p>The <code>ServiceConsumerFactory.Create</code> method returns a <code>IServiceConsumer&lt;TServiceInterface&gt;</code> type.
In all further examples, I will use the <code>var</code> keyword instead - such as:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#66d9ef">var</span> service = ServiceConsumerFactory.Create&lt;IFakeService&gt;(() =&gt; <span style="color:#66d9ef">new</span> FakeServiceClient()));
</code></pre></div><p>Alternatively, you can pass in as a string parameter the endpoint configuration name from the service client section of your application&rsquo;s .config file. For example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#66d9ef">var</span> service = ServiceConsumerFactory.Create&lt;IFakeService&gt;(<span style="color:#e6db74">&#34;BasicHttpBinding_IFakeService&#34;</span>)); 
</code></pre></div><h3 id="four-ways-to-clean-up-the-serviceconsumer">Four Ways to Clean Up the ServiceConsumer</h3>
<p>There are four ways in which the <code>ServiceConsumer</code> can be cleaned up:</p>
<ol>
<li>Implicitly via the Using statement;</li>
<li>Explicitly with the Close method;</li>
<li>Explicitly with the Dispose method; or</li>
<li>Automatically by the Garbage Collector.</li>
</ol>
<h4 id="1-the-using-statement">1. The Using Statement</h4>
<p>The recommended and easiest way to use the ServiceConsumer is with the <code>using</code> statement - because it is a well behaved implementation of <code>IDisposable</code> (unlike Microsoft&rsquo;s service clients!).
The service channel will automatically be correctly disposed and closed or aborted, no matter what happens.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#66d9ef">using</span> (<span style="color:#66d9ef">var</span> service = ServiceConsumerFactory.Create&lt;IFakeService&gt;(() =&gt; <span style="color:#66d9ef">new</span> FakeServiceClient())))
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>    ...
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>}
</code></pre></div><h4 id="2-the-close-method">2. The Close Method</h4>
<p>The <code>ServiceConsumer</code> and underlying channel can be closed immediately by calling the <code>Close</code> method on the <code>ServiceConsumer</code> instance.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>service.Close();
</code></pre></div><p>If you want to, you still can immediately call another service operation via that same <code>ServiceConsumer</code> instance, as under the covers, a new service channel will be created seamlessly and automatically.</p>
<h4 id="3-the-dispose-method">3. The Dispose Method</h4>
<p>The <code>ServiceConsumer</code> and underlying channel can be disposed of immediately by calling the <code>Dispose</code> method on the <code>ServiceConsumer</code> instance.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>service.Dispose();
</code></pre></div><p>As per standard <code>IDisposable</code> concepts, you should not attempt to reuse the <code>ServiceConsumer</code> after disposing it.</p>
<h4 id="4-garbage-collection">4. Garbage Collection</h4>
<p>If you happen to accidently forget to wrap your <code>ServiceConsumer</code> instance in a <code>Using</code> statement or call the <code>Close</code> method, rest assured that the <code>ServiceConsumer</code> will still be cleaned up! When the <code>ServiceConsumer</code> instance goes out of scope, the .NET Garbage Collector will [eventually] kick in and call its destructor/finalise method, thus correctly cleaning up the service channel and preventing any leaks.</p>
<p>Since there is an indeterminate amount of time before the Garbage Collector kicks in, I would recommend the <code>Using</code> statement approach, as it minimises the number of open channels and other resources currently in use, over the lifetime of your application.</p>
<h3 id="how-to-call-a-service-operation">How To Call a Service Operation</h3>
<p>There are two ways in which to call a service operation via the <code>ServiceConsumer</code>:</p>
<ol>
<li>Via the <code>Operations</code> property; or</li>
<li>Via the <code>Consume</code> method.</li>
</ol>
<h3 id="the-operations-property">The Operations Property</h3>
<p>The <code>Operations</code> property exposes the interface of your service. It can be used just like the normal service client that you already would be familiar with.</p>
<p>Below is an example of how to call the <code>AddIntegers</code> operation via the <code>Operations</code> property.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#66d9ef">using</span> (<span style="color:#66d9ef">var</span> service = ServiceConsumerFactory.Create&lt;IFakeService&gt;(() =&gt; <span style="color:#66d9ef">new</span> FakeServiceClient())))
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>    <span style="color:#66d9ef">try</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>        <span style="color:#66d9ef">int</span> actualValue = service.Operations.AddIntegers(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>        ...
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span>    ...
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9</span>}
</code></pre></div><p>And below is an example of how to do some exception handling with it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#66d9ef">using</span> (<span style="color:#66d9ef">var</span> service = ServiceConsumerFactory.Create&lt;IFakeService&gt;(() =&gt; <span style="color:#66d9ef">new</span> FakeServiceClient())))
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    <span style="color:#66d9ef">try</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>        <span style="color:#66d9ef">int</span> actualValue = service.Operations.AddIntegers(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>        ...
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    <span style="color:#66d9ef">catch</span> (FaultException&lt;MyCustomException&gt; fe)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>        Console.WriteLine(<span style="color:#e6db74">&#34;Service operation threw a custom fault: &#34;</span> + fe.ToString());
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    <span style="color:#66d9ef">catch</span> (FaultException fe)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>        Console.WriteLine(<span style="color:#e6db74">&#34;Service operation threw a fault: &#34;</span> + fe.ToString());
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>    <span style="color:#66d9ef">catch</span> (Exception ex)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>        Console.WriteLine(<span style="color:#e6db74">&#34;An unexpected error occurred while calling the service operation: &#34;</span> + ex.ToString());
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>}
</code></pre></div><p>There is no need to catch a <code>CommunicationException</code> or <code>TimeOutException</code> and try to perform the Close/Abort pattern, as the underlying channel is dealt with automatically for you by the <code>ServiceConsumer</code>.</p>
<h3 id="the-consume-method">The Consume Method</h3>
<p>As an alternative to the <code>Operations</code> property, you can call a service operation via the <code>Consume</code> method on the <code>ServiceConsumer</code> instance.</p>
<p>The <code>Consume</code> method returns an instance of <code>IOperationResult&lt;TReturnTypeOfYourOperation&gt;</code> which wraps the result of the operation. This interface has the following helpful properties:</p>
<ul>
<li><code>TReturnTypeOfYourOperation Value</code> - which gives you access to the return value from the operation;</li>
<li><code>bool HasException</code> - whether there was an exception thrown by the service operation;</li>
<li><code>bool HasNoException</code> - whether there was not an exception thrown by the service operation;</li>
<li><code>bool HasFaultException</code> - whether an exception of type <code>FaultException</code> was thrown by the service operation;</li>
<li><code>bool HasFaultException&lt;OfThisType&gt;</code> - whether an exception of <code>FaultException&lt;OfThisType&gt;</code> was thrown by the service operation; and</li>
<li><code>Exception Exception</code> - the exception that was thrown by the service operation.</li>
</ul>
<p>Below is an example of how to call the <code>AddIntegers</code> operation via the <code>Consume</code> method.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#66d9ef">using</span> (<span style="color:#66d9ef">var</span> service = ServiceConsumerFactory.Create&lt;IFakeService&gt;(() =&gt; <span style="color:#66d9ef">new</span> FakeServiceClient())))
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>	IOperationResult&lt;<span style="color:#66d9ef">int</span>&gt; result = service.Consume(operation =&gt; operation.AddIntegers(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    <span style="color:#66d9ef">if</span> (result.HasNoException)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        Console.WriteLine(<span style="color:#e6db74">&#34;Result was: &#34;</span> + result.Value);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>        ...
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    ...
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>}
</code></pre></div><p>And below is an example of how to do some exception handling with <code>IOperationResult</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#66d9ef">using</span> (<span style="color:#66d9ef">var</span> service = ServiceConsumerFactory.Create&lt;IFakeService&gt;(() =&gt; <span style="color:#66d9ef">new</span> FakeServiceClient())))
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    <span style="color:#66d9ef">var</span> result = service.Consume(operation =&gt; operation.AddIntegers(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    <span style="color:#66d9ef">if</span> (result.HasNoException)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        Console.WriteLine(<span style="color:#e6db74">&#34;Result was: &#34;</span> + result.Value);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    <span style="color:#66d9ef">else</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>        <span style="color:#66d9ef">if</span> (result.HasFaultExceptionOfType&lt;MyCustomException&gt;())
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>        {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>            Console.WriteLine(<span style="color:#e6db74">&#34;Service operation threw a custom fault: &#34;</span> + result.Exception.ToString());
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>        <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (result.HasFaultException)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>        {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>            Console.WriteLine(<span style="color:#e6db74">&#34;Service operation threw a fault: &#34;</span> + result.Exception.ToString());
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>        <span style="color:#66d9ef">else</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>        {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>            Console.WriteLine(<span style="color:#e6db74">&#34;An unexpected error occurred while calling the service operation: &#34;</span> + result.Exception.ToString());
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>}
</code></pre></div><p>If you generated async Task methods with your service client, and if you call those async Task methods with Consume(), the task will be executed immediately/synchronously.</p>
<h3 id="the-consumeasync-method">The ConsumeAsync Method</h3>
<p>Use ConsumeAsync() to asynchronously execute async Task methods on your service client. The syntax is the same as the Consume() example above.</p>
<h3 id="sample-usage-code">Sample Usage Code</h3>
<p>For more sample code, please see <a href="https://channeladamwcf.codeplex.com/SourceControl/latest#src/ChannelAdam.Wcf.BehaviourSpecs/SampleUsage.cs" target="_blank">SampleUsage.cs</a>.</p>

        
        </div>

        
        <div class="content-page-tags">
            
            <a href="https://devzone.channeladam.com/tags/wcf/">WCF</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/windows-communication-foundation/">Windows Communication Foundation</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/channeladam-.net-libraries/">ChannelAdam .NET Libraries</a>&nbsp;
            
        </div>
        

    </article>
    
    <article class="content-page-preview">
        <a href="https://devzone.channeladam.com/library/channeladam-wcf/v1/close-triggers/">
            <h2 class="post-title">Channel Close Trigger Strategies</h2>
        </a>

        <div class="content-page-entry">
        
            <h1 id="channeladam-wcf-library-mdash-version-1-documentationlibrarychanneladam-wcfv1"><a href="/library/channeladam-wcf/v1">ChannelAdam WCF Library — Version 1 Documentation</a></h1>
<h2 id="channel-close-trigger-strategies">Channel Close Trigger Strategies</h2>
<h3 id="overview">Overview</h3>
<p>When an exception occurs while calling the service operation, the <code>ServiceConsumer</code> follows a specific strategy to determine whether the exception and/or current channel state is severe enough to necessitate and trigger the closing/aborting of the service channel.</p>
<p>These &ldquo;Service Channel Close Trigger Strategies&rdquo; are an implementation of the interface <code>IServiceChannelCloseTriggerStrategy</code>. There is one method in this interface:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#66d9ef">bool</span> ShouldCloseChannel(ICommunicationObject channel, Exception exception);
</code></pre></div><p>If the method <code>ShouldCloseChannel</code> returns <code>true</code>, then the <code>ServiceConsumer</code> will perform the Close/Abort pattern.</p>
<h3 id="the-out-of-the-box-strategy">The Out-Of-The-Box Strategy</h3>
<p>Out of the box, the <code>DefaultServiceChannelCloseTriggerStrategy</code> is used. This strategy is very simple, effective and safe. It triggers a close to occur if the exception is anything but a <code>FaultException</code>, regardless of the state of the service channel. It is highly probable that the channel is no longer usable in the case where there was any other type of exception.</p>
<h3 id="use-your-own">Use Your Own</h3>
<p>If you find that this strategy does not suit your need, you can create your own class that implements that interface and specify your class as one of the overloads of the <code>Create</code> method on the <code>ServiceConsumerFactory</code>. Alternatively, you can directly set the property <code>ChannelCloseTriggerStrategy</code> on the <code>ServiceConsumer</code> instance itself.</p>

        
        </div>

        
        <div class="content-page-tags">
            
            <a href="https://devzone.channeladam.com/tags/wcf/">WCF</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/windows-communication-foundation/">Windows Communication Foundation</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/channeladam-.net-libraries/">ChannelAdam .NET Libraries</a>&nbsp;
            
        </div>
        

    </article>
    
    <article class="content-page-preview">
        <a href="https://devzone.channeladam.com/library/channeladam-wcf/v2/close-triggers/">
            <h2 class="post-title">Channel Close Trigger Strategies</h2>
        </a>

        <div class="content-page-entry">
        
            <h1 id="channeladam-wcf-library-mdash-version-2-documentationlibrarychanneladam-wcfv2"><a href="/library/channeladam-wcf/v2">ChannelAdam WCF Library — Version 2 Documentation</a></h1>
<h2 id="channel-close-trigger-strategies">Channel Close Trigger Strategies</h2>
<h3 id="overview">Overview</h3>
<p>When an exception occurs while calling the service operation, the <code>ServiceConsumer</code> follows a specific strategy to determine whether the exception and/or current channel state is severe enough to necessitate and trigger the closing/aborting of the service channel.</p>
<p>These &ldquo;Service Channel Close Trigger Strategies&rdquo; are an implementation of the interface <code>IServiceChannelCloseTriggerStrategy</code>. There is one method in this interface:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#66d9ef">bool</span> ShouldCloseChannel(ICommunicationObject channel, Exception exception);
</code></pre></div><p>If the method <code>ShouldCloseChannel</code> returns <code>true</code>, then the <code>ServiceConsumer</code> will perform the Close/Abort pattern.</p>
<h3 id="the-out-of-the-box-strategy">The Out-Of-The-Box Strategy</h3>
<p>Out of the box, the <code>DefaultServiceChannelCloseTriggerStrategy</code> is used. This strategy is very simple, effective and safe. It triggers a close to occur if the exception is anything but a <code>FaultException</code>, regardless of the state of the service channel. It is highly probable that the channel is no longer usable in the case where there was any other type of exception.</p>
<h3 id="use-your-own">Use Your Own</h3>
<p>If you find that this strategy does not suit your need, you can create your own class that implements that interface and specify your class as one of the overloads of the <code>Create</code> method on the <code>ServiceConsumerFactory</code>. Alternatively, you can directly set the property <code>ChannelCloseTriggerStrategy</code> on the <code>ServiceConsumer</code> instance itself.</p>

        
        </div>

        
        <div class="content-page-tags">
            
            <a href="https://devzone.channeladam.com/tags/wcf/">WCF</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/windows-communication-foundation/">Windows Communication Foundation</a>&nbsp;
            
            <a href="https://devzone.channeladam.com/tags/channeladam-.net-libraries/">ChannelAdam .NET Libraries</a>&nbsp;
            
        </div>
        

    </article>
    

    
    <ul class="pager main-pager">
        
            <li class="previous">
            <a href="/series/channeladam-.net-libraries/page/2/">&larr; more recent</a>
            </li>
        
        
            <li class="next">
            <a href="/series/channeladam-.net-libraries/page/4/">less recent &rarr;</a>
            </li>
        
    </ul>
    


                    <div class="mt2">
                    <section class="mx-auto" style="max-width:728px">
    <br/>
    <div data-type="ad" data-publisher="devzone.channeladam.com" data-zone="ron" data-format="728x90"></div>
    <br/>
</section>
                </div>
            </div>
        </div>
    </main>

    <aside class="page-layout-right-panel">
    


<div class="card-container">
    <div class="widget card">
        <div class="h1">Featured Content</div>

        <div class="h2">.NET 5.0</div>
        <ul>
            <li><a href="/notebooks/languages/dotnet/editorconfig-distribution">Distribution of a Common EditorConfig File to Multiple .NET Projects</a></li>
            <li><a href="/notebooks/languages/dotnet/net-5-guidance-for-library-developers">.NET 5.0 and Guidance for Library Developers</a></li>
        </ul>

        <div class="h2">BDD</div>
        <ul>
            <li><a href="/library/bdd-behaviour-specification-handbook">The Behaviour Specification Handbook</a></li>
        </ul>

        <div class="h2">WCF</div>
        <ul>
            <li><a href="/articles/2014/07/how-to-call-wcf-service-properly">How To Call WCF Services Properly</a></li>
            <li><a href="/articles/2014/09/how-to-easily-call-wcf-service-properly">How To Easily Call WCF Services Properly</a></li>
        </ul>

    </div>
</div>

<div class="card-container">
    <div class="widget card">
        <div class="h1">Code Libraries</div>

        <div class="h2">.NET Pattern Implementations</div>
        <ul>
            <li><a href="/library/channeladam-commands">ChannelAdam Commands Library</a></li>
            <li><a href="/library/channeladam-disposing">ChannelAdam Disposing Library</a></li>
            <li><a href="/library/channeladam-transientfaulthandling">ChannelAdam Transient Fault Handling Library</a></li>
            <li><a href="/library/channeladam-weakevents">ChannelAdam Weak Events Library</a></li>
        </ul>

        <div class="h2">.NET Helpers / Utilities</div>
        <ul>
            <li><a href="/library/channeladam-dispatchproxies">ChannelAdam Dispatch Proxies Library</a></li>
            <li><a href="/library/channeladam-logging">ChannelAdam Logging Library</a></li>
            <li><a href="/library/channeladam-primitiveextensions">ChannelAdam Primitive Extensions Library</a></li>
            <li><a href="/library/channeladam-reflection">ChannelAdam Reflection Library</a></li>
            <li><a href="/library/channeladam-soap">ChannelAdam SOAP 1.1 / 1.2 Library</a></li>
            <li><a href="/library/channeladam-xml">ChannelAdam XML Library</a></li>
        </ul>
   
        <div class="h2">Testing</div>
        <ul>
            <li><a href="/library/channeladam-testframework">ChannelAdam Test Framework Library</a></li>
            <li><a href="/library/channeladam-testframework-moq">ChannelAdam Test Framework Moq Library</a></li>
            <li><a href="/library/channeladam-testframework-mstestv2">ChannelAdam Test Framework MSTestV2 Library</a></li>
            <li><a href="/library/channeladam-testframework-nunit">ChannelAdam Test Framework NUnit Library</a></li>
            <li><a href="/library/channeladam-testframework-text">ChannelAdam Test Framework Text Library</a></li>
            <li><a href="/library/channeladam-testframework-xml">ChannelAdam Test Framework XML Library</a></li>
            <li><a href="/library/channeladam-testframework-xunit">ChannelAdam Test Framework xUnit Library</a></li>
            <li><a href="/library/channeladam-testframework-biztalk">ChannelAdam Test Framework Library for BizTalk</a></li>
        </ul>

        <div class="h2">DEPRECATED LIBRARIES</div>
        <ul>
            <li><a href="/library/channeladam-wcf">ChannelAdam WCF Library</a></li>
            <li><a href="/library/channeladam-nancy">ChannelAdam Nancy Library</a></li>
            <li><a href="/library/channeladam-nancy-hosting-self">ChannelAdam Nancy Self-Hosting Library</a></li>
            <li><a href="/library/channeladam-nancy-soap">ChannelAdam Nancy SOAP Library</a></li>
            <li><a href="/library/channeladam-testframework-mstest">ChannelAdam Test Framework MSTest Library</a></li>
            <li><a href="/library/channeladam-core">ChannelAdam Core Library</a></li>
            <li><a href="/library/channeladam-testframeworks">ChannelAdam Test Framework Libraries (V1)</a></li>
        </ul>
    </div>
</div>


<div class="card-container">
    <div class="widget card">
        <div class="h1">Connect</div>

        <div class="h2">
            





    <a class="" href="/about-me">About Me</a>

</li>
        </div>

        <div class="h2">
            <a href="https://twitter.com/ChannelAdam" target="_blank">Follow @ChannelAdam</a>
        </div>

        <section class="twitter-feed">
<a class="twitter-timeline" 
    data-width="320" 
    data-theme="dark" 
    data-link-color="#2B7BB9" 
    data-tweet-limit="10"
    href="https://twitter.com/ChannelAdam?ref_src=twsrc%5Etfw">Tweets by @ChannelAdam</a>
</section>
    </div>
</div>

<section class="mx-auto mt2" style="max-width:300px">
    <br/>
    <div data-type="ad" data-publisher="devzone.channeladam.com" data-zone="ron" data-format="300x250"></div>
    <br/>
</section>

<div class="card-container">
    <div class="widget card">
        <div class="h1">Recent Blog Posts</div>

        <ul><li><a href="/notebooks/languages/dotnet/editorconfig-distribution/">Distribution of a Common EditorConfig File to Multiple .NET Projects</a></li><li><a href="/articles/2021/01/editorconfig-distribution/">.NET Notebook Update - Distribution of a Common EditorConfig File to Multiple .NET Projects</a></li><li><a href="/articles/2021/01/channeladam-dotnet-library-updates/">ChannelAdam .NET Library Updates &amp; Deprecations</a></li><li><a href="/articles/2021/01/net-5-guidance-notes/">.NET Notebook Update - Guidance on .NET 5.0 for Library Developers</a></li><li><a href="/notebooks/languages/dotnet/net-5-guidance-for-library-developers/">.NET 5.0 and Guidance for Library Developers</a></li><li><a href="/notebooks/languages/dotnet/">Microsoft .NET Notebook</a></li><li><a href="/notebooks/languages/">Languages Notebook</a></li><li><a href="/notebooks/">Notebooks</a></li><li><a href="/articles/2020/04/changed-to-hugo/">Changed to Hugo Static Site Generator</a></li><li><a href="/articles/2018/05/service-fabric-notes-update/">Service Fabric Notebook Update</a></li><li><a href="/notebooks/distributed-systems/service-fabric/">Microsoft Service Fabric Notebook</a></li><li><a href="/notebooks/distributed-systems/">Distributed Systems Notebook</a></li><li><a href="/notebooks/distributed-systems/azure-container-service/">Azure Container Service Notebook</a></li><li><a href="/notebooks/web-development/">Web Development Notebook</a></li><li><a href="/notebooks/web-development/image-optimisation/">Image Optimisation Notebook</a></li><li><a href="/notebooks/security/pci-dss-compliance/">PCI DSS Compliance Notebook</a></li><li><a href="/articles/2018/03/announcing-new-notebooks/">Announcing New ChannelAdam Notebooks</a></li><li><a href="/notebooks/linux/nvidia-power-usage/">Linux, Nvidia Graphics Cards &amp; Power Usage Notebook</a></li><li><a href="/notebooks/data-science/">Data Science Notebook</a></li></ul>
    </div>
</div>

<section class="mx-auto mt2" style="max-width:160px">
    <br/>
    <div data-type="ad" data-publisher="devzone.channeladam.com" data-zone="ron" data-format="160x600"></div>
    <br/>
</section>

<div class="card-container">
    <div class="widget card">
        <div class="h1">Tag Cloud</div>

        
    <div class="tag-cloud"><a href="/tags/.net" style="font-size:1.5154561545121918rem">.Net</a>
        &nbsp;<a href="/tags/.net-4.0" style="font-size:1.1626083122716342rem">.Net 4.0</a>
        &nbsp;<a href="/tags/.net-5.0" style="font-size:1.4203363895277301rem">.Net 5.0</a>
        &nbsp;<a href="/tags/.net-core" style="font-size:1.4203363895277301rem">.Net Core</a>
        &nbsp;<a href="/tags/.net-framework" style="font-size:1.257728077256096rem">.Net Framework</a>
        &nbsp;<a href="/tags/.net-standard" style="font-size:1.4203363895277301rem">.Net Standard</a>
        &nbsp;<a href="/tags/.net-standard-2.0" style="font-size:1.257728077256096rem">.Net Standard 2.0</a>
        &nbsp;<a href="/tags/.net-standard-2.1" style="font-size:1.1626083122716342rem">.Net Standard 2.1</a>
        &nbsp;<a href="/tags/agile" style="font-size:1rem">Agile</a>
        &nbsp;<a href="/tags/ajax" style="font-size:1rem">Ajax</a>
        &nbsp;<a href="/tags/amazon-s3" style="font-size:1rem">Amazon S3</a>
        &nbsp;<a href="/tags/analyzerconfig" style="font-size:1.1626083122716342rem">Analyzerconfig</a>
        &nbsp;<a href="/tags/api-apps" style="font-size:1.3252166245432684rem">Api Apps</a>
        &nbsp;<a href="/tags/api-management" style="font-size:1rem">Api Management</a>
        &nbsp;<a href="/tags/app-service" style="font-size:1.3252166245432684rem">App Service</a>
        &nbsp;<a href="/tags/artificial-intelligence" style="font-size:1rem">Artificial Intelligence</a>
        &nbsp;<a href="/tags/asp.net" style="font-size:1.257728077256096rem">Asp.net</a>
        &nbsp;<a href="/tags/asp.net-mvc-3" style="font-size:1.1626083122716342rem">Asp.net Mvc 3</a>
        &nbsp;<a href="/tags/asp.net-mvc2" style="font-size:1rem">Asp.net Mvc2</a>
        &nbsp;<a href="/tags/assembly-binding" style="font-size:1.1626083122716342rem">Assembly Binding</a>
        &nbsp;<a href="/tags/async" style="font-size:1rem">Async</a>
        &nbsp;<a href="/tags/asynchronous" style="font-size:1rem">Asynchronous</a>
        &nbsp;<a href="/tags/azure" style="font-size:1.257728077256096rem">Azure</a>
        &nbsp;<a href="/tags/battery" style="font-size:1.1626083122716342rem">Battery</a>
        &nbsp;<a href="/tags/bdd" style="font-size:1.9756498736298047rem">Bdd</a>
        &nbsp;<a href="/tags/behaviour-driven" style="font-size:1.1626083122716342rem">Behaviour Driven</a>
        &nbsp;<a href="/tags/behaviour-driven-development" style="font-size:1.9756498736298047rem">Behaviour Driven Development</a>
        &nbsp;<a href="/tags/behaviour-specification-handbook" style="font-size:1.960509510525089rem">Behaviour Specification Handbook</a>
        &nbsp;<a href="/tags/behaviour-specifications" style="font-size:1.9719554003354438rem">Behaviour Specifications</a>
        &nbsp;<a href="/tags/behaviour-verification" style="font-size:1rem">Behaviour Verification</a>
        &nbsp;<a href="/tags/bitbucket" style="font-size:1rem">Bitbucket</a>
        &nbsp;<a href="/tags/biztalk" style="font-size:1.4203363895277301rem">Biztalk</a>
        &nbsp;<a href="/tags/biztalk360" style="font-size:1.1626083122716342rem">Biztalk360</a>
        &nbsp;<a href="/tags/build" style="font-size:1.3252166245432684rem">Build</a>
        &nbsp;<a href="/tags/business" style="font-size:1rem">Business</a>
        &nbsp;<a href="/tags/c" style="font-size:1rem">C#</a>
        &nbsp;<a href="/tags/channeladam-.net-libraries" style="font-size:1.8406727790554602rem">Channeladam .Net Libraries</a>
        &nbsp;<a href="/tags/channeladam.wcf" style="font-size:1.1626083122716342rem">Channeladam.wcf</a>
        &nbsp;<a href="/tags/clean-code" style="font-size:1rem">Clean Code</a>
        &nbsp;<a href="/tags/client-validation" style="font-size:1rem">Client Validation</a>
        &nbsp;<a href="/tags/code-analysis" style="font-size:1.1626083122716342rem">Code Analysis</a>
        &nbsp;<a href="/tags/code-quality" style="font-size:1rem">Code Quality</a>
        &nbsp;<a href="/tags/code-reviews" style="font-size:1rem">Code Reviews</a>
        &nbsp;<a href="/tags/code-style" style="font-size:1.1626083122716342rem">Code Style</a>
        &nbsp;<a href="/tags/coding-practices" style="font-size:1.257728077256096rem">Coding Practices</a>
        &nbsp;<a href="/tags/command" style="font-size:1.1626083122716342rem">Command</a>
        &nbsp;<a href="/tags/container" style="font-size:1.3775648087257248rem">Container</a>
        &nbsp;<a href="/tags/conventions" style="font-size:1rem">Conventions</a>
        &nbsp;<a href="/tags/cucumber" style="font-size:1rem">Cucumber</a>
        &nbsp;<a href="/tags/data-science" style="font-size:1rem">Data Science</a>
        &nbsp;<a href="/tags/ddd" style="font-size:1rem">Ddd</a>
        &nbsp;<a href="/tags/deprecated" style="font-size:1rem">Deprecated</a>
        &nbsp;<a href="/tags/diffplex" style="font-size:1rem">Diffplex</a>
        &nbsp;<a href="/tags/digital-ocean" style="font-size:1rem">Digital Ocean</a>
        &nbsp;<a href="/tags/dispatch-proxies" style="font-size:1rem">Dispatch Proxies</a>
        &nbsp;<a href="/tags/disposable" style="font-size:1rem">Disposable</a>
        &nbsp;<a href="/tags/dispose" style="font-size:1rem">Dispose</a>
        &nbsp;<a href="/tags/distributed" style="font-size:1.3775648087257248rem">Distributed</a>
        &nbsp;<a href="/tags/distributed-systems" style="font-size:1rem">Distributed Systems</a>
        &nbsp;<a href="/tags/docker-swarm" style="font-size:1rem">Docker Swarm</a>
        &nbsp;<a href="/tags/docpad" style="font-size:1rem">Docpad</a>
        &nbsp;<a href="/tags/domain-driven-design" style="font-size:1rem">Domain Driven Design</a>
        &nbsp;<a href="/tags/dynamic" style="font-size:1rem">Dynamic</a>
        &nbsp;<a href="/tags/editorconfig" style="font-size:1.1626083122716342rem">Editorconfig</a>
        &nbsp;<a href="/tags/embedded-resources" style="font-size:1rem">Embedded Resources</a>
        &nbsp;<a href="/tags/encoding" style="font-size:1rem">Encoding</a>
        &nbsp;<a href="/tags/events" style="font-size:1rem">Events</a>
        &nbsp;<a href="/tags/extensions" style="font-size:1rem">Extensions</a>
        &nbsp;<a href="/tags/failure" style="font-size:1rem">Failure</a>
        &nbsp;<a href="/tags/finalize" style="font-size:1rem">Finalize</a>
        &nbsp;<a href="/tags/fluent" style="font-size:1rem">Fluent</a>
        &nbsp;<a href="/tags/framework" style="font-size:1.257728077256096rem">Framework</a>
        &nbsp;<a href="/tags/gauge" style="font-size:1.1626083122716342rem">Gauge</a>
        &nbsp;<a href="/tags/gherkin" style="font-size:1.1626083122716342rem">Gherkin</a>
        &nbsp;<a href="/tags/github" style="font-size:1rem">Github</a>
        &nbsp;<a href="/tags/gondor" style="font-size:1rem">Gondor</a>
        &nbsp;<a href="/tags/google-app-engine" style="font-size:1rem">Google App Engine</a>
        &nbsp;<a href="/tags/google-compute-engine" style="font-size:1rem">Google Compute Engine</a>
        &nbsp;<a href="/tags/graphics" style="font-size:1rem">Graphics</a>
        &nbsp;<a href="/tags/heroku" style="font-size:1rem">Heroku</a>
        &nbsp;<a href="/tags/hosting" style="font-size:1rem">Hosting</a>
        &nbsp;<a href="/tags/hugo" style="font-size:1rem">Hugo</a>
        &nbsp;<a href="/tags/image-optimisation" style="font-size:1rem">Image Optimisation</a>
        &nbsp;<a href="/tags/injected" style="font-size:1rem">Injected</a>
        &nbsp;<a href="/tags/integration" style="font-size:1.1626083122716342rem">Integration</a>
        &nbsp;<a href="/tags/intellisense" style="font-size:1.257728077256096rem">Intellisense</a>
        &nbsp;<a href="/tags/ioc" style="font-size:1.1626083122716342rem">Ioc</a>
        &nbsp;<a href="/tags/javascript" style="font-size:1rem">Javascript</a>
        &nbsp;<a href="/tags/jpeg" style="font-size:1rem">Jpeg</a>
        &nbsp;<a href="/tags/jquery" style="font-size:1rem">Jquery</a>
        &nbsp;<a href="/tags/kestrel" style="font-size:1rem">Kestrel</a>
        &nbsp;<a href="/tags/kubernetes" style="font-size:1rem">Kubernetes</a>
        &nbsp;<a href="/tags/languages" style="font-size:1rem">Languages</a>
        &nbsp;<a href="/tags/library" style="font-size:1.5154561545121918rem">Library</a>
        &nbsp;<a href="/tags/linux" style="font-size:1.257728077256096rem">Linux</a>
        &nbsp;<a href="/tags/loaded" style="font-size:1rem">Loaded</a>
        &nbsp;<a href="/tags/logging" style="font-size:1.1626083122716342rem">Logging</a>
        &nbsp;<a href="/tags/logic-apps" style="font-size:1.3252166245432684rem">Logic Apps</a>
        &nbsp;<a href="/tags/machine-learning" style="font-size:1rem">Machine Learning</a>
        &nbsp;<a href="/tags/mapping" style="font-size:1.1626083122716342rem">Mapping</a>
        &nbsp;<a href="/tags/maps" style="font-size:1.257728077256096rem">Maps</a>
        &nbsp;<a href="/tags/mesosphere-dc/os" style="font-size:1rem">Mesosphere Dc/Os</a>
        &nbsp;<a href="/tags/messaging" style="font-size:1.1626083122716342rem">Messaging</a>
        &nbsp;<a href="/tags/methodology" style="font-size:1rem">Methodology</a>
        &nbsp;<a href="/tags/microservices" style="font-size:1rem">Microservices</a>
        &nbsp;<a href="/tags/microsoft" style="font-size:1.3252166245432684rem">Microsoft</a>
        &nbsp;<a href="/tags/microsoft-azure" style="font-size:1.3775648087257248rem">Microsoft Azure</a>
        &nbsp;<a href="/tags/mock4net" style="font-size:1rem">Mock4net</a>
        &nbsp;<a href="/tags/moq" style="font-size:1.1626083122716342rem">Moq</a>
        &nbsp;<a href="/tags/msbuild" style="font-size:1.257728077256096rem">Msbuild</a>
        &nbsp;<a href="/tags/mstest" style="font-size:1.257728077256096rem">Mstest</a>
        &nbsp;<a href="/tags/mstest-v2" style="font-size:1rem">Mstest V2</a>
        &nbsp;<a href="/tags/named-parameters" style="font-size:1rem">Named Parameters</a>
        &nbsp;<a href="/tags/naming" style="font-size:1.1626083122716342rem">Naming</a>
        &nbsp;<a href="/tags/nancy" style="font-size:1.3775648087257248rem">Nancy</a>
        &nbsp;<a href="/tags/notebooks" style="font-size:1.3775648087257248rem">Notebooks</a>
        &nbsp;<a href="/tags/nuget" style="font-size:1.1626083122716342rem">Nuget</a>
        &nbsp;<a href="/tags/nullable-reference-types" style="font-size:1rem">Nullable Reference Types</a>
        &nbsp;<a href="/tags/nunit" style="font-size:1.1626083122716342rem">Nunit</a>
        &nbsp;<a href="/tags/nvidia" style="font-size:1.1626083122716342rem">Nvidia</a>
        &nbsp;<a href="/tags/open-source" style="font-size:1.1626083122716342rem">Open Source</a>
        &nbsp;<a href="/tags/operations" style="font-size:1rem">Operations</a>
        &nbsp;<a href="/tags/optimisation" style="font-size:1rem">Optimisation</a>
        &nbsp;<a href="/tags/optional-parameters" style="font-size:1rem">Optional Parameters</a>
        &nbsp;<a href="/tags/orchestration" style="font-size:1.3775648087257248rem">Orchestration</a>
        &nbsp;<a href="/tags/paas" style="font-size:1rem">Paas</a>
        &nbsp;<a href="/tags/partial-views" style="font-size:1rem">Partial Views</a>
        &nbsp;<a href="/tags/pattern" style="font-size:1.3775648087257248rem">Pattern</a>
        &nbsp;<a href="/tags/patterns" style="font-size:1rem">Patterns</a>
        &nbsp;<a href="/tags/pci-dss" style="font-size:1rem">Pci Dss</a>
        &nbsp;<a href="/tags/png" style="font-size:1rem">Png</a>
        &nbsp;<a href="/tags/power" style="font-size:1.1626083122716342rem">Power</a>
        &nbsp;<a href="/tags/powershell" style="font-size:1.6017222572298446rem">Powershell</a>
        &nbsp;<a href="/tags/principles" style="font-size:1rem">Principles</a>
        &nbsp;<a href="/tags/probing-privatepath" style="font-size:1rem">Probing Privatepath</a>
        &nbsp;<a href="/tags/productivity" style="font-size:1rem">Productivity</a>
        &nbsp;<a href="/tags/program-specification" style="font-size:1rem">Program Specification</a>
        &nbsp;<a href="/tags/programming" style="font-size:1.1626083122716342rem">Programming</a>
        &nbsp;<a href="/tags/python" style="font-size:1rem">Python</a>
        &nbsp;<a href="/tags/r" style="font-size:1rem">R</a>
        &nbsp;<a href="/tags/razor" style="font-size:1.1626083122716342rem">Razor</a>
        &nbsp;<a href="/tags/real-proxies" style="font-size:1rem">Real Proxies</a>
        &nbsp;<a href="/tags/redhat-openshift" style="font-size:1rem">Redhat Openshift</a>
        &nbsp;<a href="/tags/reflection" style="font-size:1rem">Reflection</a>
        &nbsp;<a href="/tags/retry" style="font-size:1rem">Retry</a>
        &nbsp;<a href="/tags/reversible" style="font-size:1.1626083122716342rem">Reversible</a>
        &nbsp;<a href="/tags/scale" style="font-size:1.3775648087257248rem">Scale</a>
        &nbsp;<a href="/tags/scenarios" style="font-size:1.9719554003354438rem">Scenarios</a>
        &nbsp;<a href="/tags/script" style="font-size:1rem">Script</a>
        &nbsp;<a href="/tags/security" style="font-size:1rem">Security</a>
        &nbsp;<a href="/tags/self" style="font-size:1rem">Self</a>
        &nbsp;<a href="/tags/serialization" style="font-size:1rem">Serialization</a>
        &nbsp;<a href="/tags/service" style="font-size:1rem">Service</a>
        &nbsp;<a href="/tags/service-bus" style="font-size:1rem">Service Bus</a>
        &nbsp;<a href="/tags/service-bus-connector" style="font-size:1rem">Service Bus Connector</a>
        &nbsp;<a href="/tags/service-fabric" style="font-size:1.257728077256096rem">Service Fabric</a>
        &nbsp;<a href="/tags/serviceconsumer" style="font-size:1.1626083122716342rem">Serviceconsumer</a>
        &nbsp;<a href="/tags/services" style="font-size:1.3775648087257248rem">Services</a>
        &nbsp;<a href="/tags/single-responsibility-principle" style="font-size:1rem">Single Responsibility Principle</a>
        &nbsp;<a href="/tags/singleton" style="font-size:1rem">Singleton</a>
        &nbsp;<a href="/tags/soa" style="font-size:1rem">Soa</a>
        &nbsp;<a href="/tags/soap-1.1" style="font-size:1.3252166245432684rem">Soap 1.1</a>
        &nbsp;<a href="/tags/soap-1.2" style="font-size:1.3252166245432684rem">Soap 1.2</a>
        &nbsp;<a href="/tags/solid" style="font-size:1.257728077256096rem">Solid</a>
        &nbsp;<a href="/tags/specflow" style="font-size:1.1626083122716342rem">Specflow</a>
        &nbsp;<a href="/tags/srp" style="font-size:1rem">Srp</a>
        &nbsp;<a href="/tags/standards" style="font-size:1rem">Standards</a>
        &nbsp;<a href="/tags/static-site-generator" style="font-size:1rem">Static Site Generator</a>
        &nbsp;<a href="/tags/teamreview" style="font-size:1rem">Teamreview</a>
        &nbsp;<a href="/tags/test-driven-development" style="font-size:1rem">Test Driven Development</a>
        &nbsp;<a href="/tags/test-framework" style="font-size:1.5154561545121918rem">Test Framework</a>
        &nbsp;<a href="/tags/testing" style="font-size:1.996672366820611rem">Testing</a>
        &nbsp;<a href="/tags/text" style="font-size:1rem">Text</a>
        &nbsp;<a href="/tags/tfs" style="font-size:1.1626083122716342rem">Tfs</a>
        &nbsp;<a href="/tags/thread-safe" style="font-size:1rem">Thread Safe</a>
        &nbsp;<a href="/tags/transient-fault-handling" style="font-size:1rem">Transient Fault Handling</a>
        &nbsp;<a href="/tags/validation" style="font-size:1rem">Validation</a>
        &nbsp;<a href="/tags/vb.net" style="font-size:1rem">Vb.net</a>
        &nbsp;<a href="/tags/visual-studio" style="font-size:1.456499245823252rem">Visual Studio</a>
        &nbsp;<a href="/tags/visual-studio-2010" style="font-size:1.3252166245432684rem">Visual Studio 2010</a>
        &nbsp;<a href="/tags/waterfall" style="font-size:1rem">Waterfall</a>
        &nbsp;<a href="/tags/wcf" style="font-size:1.7142273230793479rem">Wcf</a>
        &nbsp;<a href="/tags/weak" style="font-size:1rem">Weak</a>
        &nbsp;<a href="/tags/weak-events" style="font-size:1rem">Weak Events</a>
        &nbsp;<a href="/tags/web" style="font-size:1.3252166245432684rem">Web</a>
        &nbsp;<a href="/tags/web-apps" style="font-size:1.1626083122716342rem">Web Apps</a>
        &nbsp;<a href="/tags/web-development" style="font-size:1.3252166245432684rem">Web Development</a>
        &nbsp;<a href="/tags/windows" style="font-size:1.6017222572298446rem">Windows</a>
        &nbsp;<a href="/tags/windows-communication-foundation" style="font-size:1.678064466783826rem">Windows Communication Foundation</a>
        &nbsp;<a href="/tags/windows-communication-framework" style="font-size:1.257728077256096rem">Windows Communication Framework</a>
        &nbsp;<a href="/tags/work-items" style="font-size:1rem">Work Items</a>
        &nbsp;<a href="/tags/xml" style="font-size:1.257728077256096rem">Xml</a>
        &nbsp;<a href="/tags/xmlunit" style="font-size:1rem">Xmlunit</a>
        &nbsp;<a href="/tags/xunit" style="font-size:1rem">Xunit</a>
        &nbsp;</div>

    </div>
</div>




    </aside>
</div>

    <footer>
    <div class="page-width mx-auto flex flex-wrap items-center justify-around">
        <small>
            Copyright &copy; 2009-2020 by Adam Craven. All rights reserved.
            <br/><br/>
        </small>

        <small class="center">
            <a href="https://creativecommons.org/licenses/by/4.0/" rel="license" target="_blank">
                <img alt="Creative Commons Licence" src="https://licensebuttons.net/l/by/4.0/88x31.png" style="border-width: 0;" /></a>
            <br />
            This work is licensed under a
            <br />
            <a href="https://creativecommons.org/licenses/by/4.0/" rel="license" target="_blank">Creative Commons Attribution 4.0 International License</a>.
        </small>
    </div>
</footer>
        </div>
</div>
    <script>
    //================================================================
// Twitter widgets - e.g. follow button
!function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (!d.getElementById(id)) {
        js = d.createElement(s); js.id = id; js.async = true; js.defer = true;
        js.src = 'https://platform.twitter.com/widgets.js';
        fjs.parentNode.insertBefore(js, fjs);
    }
}(document, 'script', 'twitter-wjs');
    (function () {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true; po.defer = true;
    po.src = 'https://platform.linkedin.com/in.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
})();
</script>
<script>
window.twttr = (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0], t = window.twttr || {};
    if (d.getElementById(id)) return t;
    js = d.createElement(s);
    js.id = id;
    js.src = "https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js, fjs);
    t._e = [];
    t.ready = function(f) {
        t._e.push(f);
    };
    return t;
}(document, "script", "twitter-wjs"));
</script>
<script>
function _dmBootstrap(file) {
	var _dma = document.createElement('script');
	_dma.type = 'text/javascript';
	_dma.async = true; _dma.defer = true;
	_dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + file;
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
}
function _dmFollowup(file) { if (typeof DMAds === 'undefined')  _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js');}
(function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js'); setTimeout(_dmFollowup, 2000);})();
</script>

  </body>
</html>
